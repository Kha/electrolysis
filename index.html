<html>
<head>
  <meta charset="utf-8">
  <link href="rust.css" rel="stylesheet">
  <link href="ref.css" rel="stylesheet">
  <link href="highlight.css" rel="stylesheet">
  <script src="ref.js"></script>
</head>
<body class="rustdoc">
  <h1 class="title">Electrolysis Reference</h1>
  <p>This document shows <a href="https://github.com/Kha/electrolysis">electrolysis</a>'s current coverage of the <a href="https://doc.rust-lang.org/reference.html">Rust Reference</a> by testing the translation of code examples (taken from the Reference or made up on the spot). Some sections have been added on top of the Reference to display details and edge cases.</p>

<p>A ✔ means the translated Lean code type checks, whereas a ✗ marks unimplemented language features. A few examples also come with example Lean proofs that are also checked automatically and give greater assurance of semantics preservation.</p>

  <nav id="TOC"><ul>
<li><a class="success" href="#notation,-lexical-structure,-syntax-extensions.">Notation, Lexical structure, Syntax extensions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#crates-and-source-files">5 Crates and source files</a>
<ul>
</ul>
</li>
<li><a class="" href="#items-and-attributes">6 Items And Attributes</a>
<ul>
<li><a class="" href="#items">6.1 Items</a>
<ul>
<li><a class="success" href="#modules">6.1.2 Modules</a>
<ul>
</ul>
</li>
<li><a class="" href="#functions">6.1.3 Functions</a>
<ul>
<li><a class="success" href="#generic-functions">6.1.3.1 Generic functions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#diverging-functions">6.1.3.2 Diverging functions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#returning-mutable-reference-to-first-argument.">Returning mutable reference to first argument</a>
<ul>
</ul>
</li>
<li><a class="fail" href="#returning-arbitrary-mutable-references.">Returning arbitrary mutable references</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#type-aliases">6.1.4 Type aliases</a>
<ul>
</ul>
</li>
<li><a class="success" href="#structs">6.1.5 Structs</a>
<ul>
</ul>
</li>
<li><a class="success" href="#enumerations">6.1.6 Enumerations</a>
<ul>
<li><a class="success" href="#struct-like-enum-variants.">Struct-like enum variants</a>
<ul>
</ul>
</li>
<li><a class="success" href="#enum-discriminants.">Enum discriminants</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#constant-items">6.1.7 Constant items</a>
<ul>
</ul>
</li>
<li><a class="success" href="#static-items">6.1.8 Static items</a>
<ul>
</ul>
</li>
<li><a class="" href="#traits">6.1.9 Traits</a>
<ul>
<li><a class="success" href="#generic-traits-and-trait-methods.">Generic traits and trait methods</a>
<ul>
</ul>
</li>
<li><a class="success" href="#default-methods.">Default methods</a>
<ul>
</ul>
</li>
<li><a class="fail" href="#calling-default-methods-from-inside-the-trait.">Calling default methods from inside the trait</a>
<ul>
</ul>
</li>
<li><a class="fail" href="#overriding-default-methods.">Overriding default methods</a>
<ul>
</ul>
</li>
<li><a class="success" href="#trait-bounds.">Trait bounds</a>
<ul>
</ul>
</li>
<li><a class="success" href="#associated-types.">Associated types</a>
<ul>
</ul>
</li>
<li><a class="fail" href="#trait-objects.">Trait objects</a>
<ul>
</ul>
</li>
<li><a class="success" href="#static-trait-methods.">Static trait methods</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#implementations">6.1.10 Implementations</a>
<ul>
<li><a class="success" href="#trait-implementations.">Trait implementations</a>
<ul>
</ul>
</li>
<li><a class="success" href="#that-other-type-of-implementations.">That other type of implementations</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#attributes">6.3 Attributes</a>
<ul>
<li><a class="success" href="#conditional-compilation">6.3.8 Conditional compilation</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="" href="#statements-and-expressions">7 Statements and expressions</a>
<ul>
<li><a class="success" href="#statements">7.1 Statements</a>
<ul>
<li><a class="success" href="#declaration-statements">7.1.1 Declaration Statements</a>
<ul>
<li><a class="success" href="#item-declarations">7.1.1.1 Item declarations</a>
<ul>
</ul>
</li>
<li><a class="success" href="#let-statements">7.1.1.2 let statements</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#expression-statements">7.1.2 Expression statements</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="" href="#expressions">7.2 Expressions</a>
<ul>
<li><a class="success" href="#literal-expressions">7.2.1 Literal expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#tuple-expressions">7.2.3 Tuple expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#struct-expressions">7.2.4 Struct expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#block-expressions">7.2.5 Block expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#method-call-expressions">7.2.6 Method-call expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#field-expressions">7.2.7 Field expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#array-expressions">7.2.8 Array expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#index-expressions">7.2.9 Index expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#range-expressions">7.2.10 Range expressions</a>
<ul>
</ul>
</li>
<li><a class="" href="#unary-operator-expressions">7.2.11 Unary operator expressions</a>
<ul>
<li><a class="" href="#mutable-borrowing.">Mutable borrowing</a>
<ul>
<li><a class="success" href="#basic-borrowing-of-local-paths.">Basic borrowing of local paths</a>
<ul>
</ul>
</li>
<li><a class="success" href="#reborrowing.">Reborrowing</a>
<ul>
</ul>
</li>
<li><a class="fail" href="#nested-storing-of-mut-refs.">Nested storing of mut refs</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#binary-operator-expressions">7.2.12 Binary operator expressions</a>
<ul>
<li><a class="success" href="#arithmetic-operators">7.2.12.1 Arithmetic operators</a>
<ul>
</ul>
</li>
<li><a class="success" href="#bitwise-operators">7.2.12.2 Bitwise operators</a>
<ul>
</ul>
</li>
<li><a class="success" href="#lazy-boolean-operators">7.2.12.3 Lazy boolean operators</a>
<ul>
</ul>
</li>
<li><a class="success" href="#comparison-operators">7.2.12.4 Comparison operators</a>
<ul>
</ul>
</li>
<li><a class="success" href="#type-cast-expressions">7.2.12.5 Type cast expressions</a>
<ul>
<li><a class="success" href="#integral-casts.">Integral casts</a>
<ul>
</ul>
</li>
<li><a class="success" href="#unsize-casts.">Unsize casts</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#assignment-expressions">7.2.12.6 Assignment expressions</a>
<ul>
<li><a class="success" href="#assignment-through-lvalue-paths.">Assignment through lvalue paths</a>
<ul>
</ul>
</li>
<li><a class="success" href="#assignment-through-mut-refs.">Assignment through mut refs</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#compound-assignment-expressions">7.2.12.7 Compound assignment expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#call-expressions">7.2.14 Call expressions</a>
<ul>
<li><a class="success" href="#mutable-reference-parameters.">Mutable reference parameters</a>
<ul>
</ul>
</li>
<li><a class="success" href="#mutable-references-as-return-values.">Mutable references as return values</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#lambda-expressions">7.2.15 Lambda expressions</a>
<ul>
<li><a class="success" href="#mutable-closures.">Mutable closures</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="" href="#loops.">Loops</a>
<ul>
<li><a class="fail" href="#mutable-borrowing-in-loops.">Mutable borrowing in loops</a>
<ul>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#if-expressions">7.2.21 if expressions</a>
<ul>
</ul>
</li>
<li><a class="success" href="#match-expressions">7.2.22 Match expressions</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="success" href="#type-system">8 Type system</a>
<ul>
</ul>
</li>
</ul></nav>
  <h1 id="notation,-lexical-structure,-syntax-extensions."><a href="#notation,-lexical-structure,-syntax-extensions." class="success">Notation, Lexical structure, Syntax extensions</a>
</h1>
<p>Well, that's what MIR is for.</p>
<h1 id="crates-and-source-files"><a href="#crates-and-source-files" class="success">5 Crates and source files</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#crates-and-source-files">[ref]</a>
</h1>
<p>Skeleton code that surrounds each transpilation, which will be hidden in all further examples. The crate name ('test' in these examples) becomes the root namespace.</p>
<p>Files inside a crate may freely reference items between them. On the other
hand, Lean files may only import other files non-recursively and declarations
must be strictly sorted in order of usage for termination checking. We therefore
translate a crate into a single Lean file and perform a topological sort on its
items.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="c1">// this file intentionally left blank</span>
</pre></div>
<div class="mir"><pre>
</pre></div>
<div class="lean"><pre><span class="kn">import</span> <span class="n">core</span><span class="bp">.</span><span class="n">generated</span>

<span class="kn">noncomputable</span> <span class="kn">theory</span>

<span class="kn">open</span> <span class="n">bool</span>
<span class="kn">open</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="n">classical</span>
<span class="kn">open</span> <span class="o">[</span><span class="kn">notation</span><span class="o">]</span> <span class="n">function</span>
<span class="kn">open</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="n">int</span>
<span class="kn">open</span> <span class="o">[</span><span class="kn">notation</span><span class="o">]</span> <span class="n">list</span>
<span class="kn">open</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="n">nat</span>
<span class="kn">open</span> <span class="o">[</span><span class="kn">notation</span><span class="o">]</span> <span class="n">prod</span><span class="bp">.</span><span class="n">ops</span>
<span class="kn">open</span> <span class="o">[</span><span class="kn">notation</span><span class="o">]</span> <span class="n">unit</span>
</pre></div>
</div>
</div>
<h1 id="items-and-attributes"><a href="#items-and-attributes" class="">6 Items And Attributes</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#items-and-attributes">[ref]</a>
</h1>
<h2 id="items"><a href="#items" class="">6.1 Items</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#items">[ref]</a>
</h2>
<h3 id="modules"><a href="#modules" class="success">6.1.2 Modules</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#modules">[ref]</a>
</h3>
<p>Modules are translated to namespaces. <code>extern crate</code> and <code>use</code> directives are ignored, instead external theories are imported when some item of them is used.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="kn">mod</span> <span class="n">foo</span> <span class="p">{</span>
    <span class="kn">use</span> <span class="n">std</span><span class="o">::</span><span class="n">cmp</span><span class="o">::</span><span class="n">Ordering</span><span class="p">;</span>

    <span class="k">struct</span> <span class="n">Bar</span><span class="p">(</span><span class="n">Ordering</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre>
</pre></div>
<div class="lean"><pre><span class="kn">inductive</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">Bar</span> <span class="o">:=</span>
<span class="n">mk</span> <span class="o">{}</span> <span class="o">:</span> <span class="o">(</span><span class="n">core</span><span class="bp">.</span><span class="n">cmp</span><span class="bp">.</span><span class="n">Ordering</span><span class="o">)</span> <span class="bp">→</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">Bar</span>
</pre></div>
</div>
</div>
<h3 id="functions"><a href="#functions" class="">6.1.3 Functions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#functions">[ref]</a>
</h3>
<p>Rust <code>fn</code>s are translated to curried definitions. The return type is wrapped in a semantics monad, which in the simplest case is <code>option</code> for modelling nontermination. The proofs unwrap it using <code>sem.terminates_with h x</code>, which asserts that <code>x</code> terminates and that the predicate <code>h</code> holds on the return value.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">first</span><span class="p">((</span><span class="n">value</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">i32</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span> <span class="n">value</span> <span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">first</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">i32</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;value&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:11: 5:16</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:11: 5:16</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:11: 5:16</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:43: 5:48</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:43: 5:48</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:43: 5:48</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:50: 5:50</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:50: 5:50</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:5:50: 5:50</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">add</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:1:8: 1:9</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:1:16: 1:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:1:8: 1:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:1:8: 1:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:1:16: 1:17</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:1:16: 1:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:2:5: 2:6</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:2:5: 2:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:2:9: 2:10</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:2:9: 2:10</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_6</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:2:5: 2:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_7</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:2:5: 2:10</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">_7</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:2:5: 2:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:3:2: 3:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">add</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t5</span> <span class="n">t6</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t7</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">first</span> <span class="o">(</span><span class="err">«$</span><span class="n">a1</span><span class="err">»</span> <span class="o">:</span> <span class="o">(</span><span class="n">i32</span> <span class="bp">×</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">value</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="err">«$</span><span class="n">a1</span><span class="err">»</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">value</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t3</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">[</span><span class="n">is_i32</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)]</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">sum</span><span class="o">,</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">sum</span><span class="o">)</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">add</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="kp">rewrite</span> <span class="o">[</span><span class="bp">↑</span><span class="n">test</span><span class="bp">.</span><span class="n">add</span><span class="o">,</span> <span class="n">if_pos</span> <span class="bp">`</span><span class="n">is_i32</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span><span class="bp">`</span><span class="o">,</span> <span class="bp">▸*</span><span class="o">]</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">z</span><span class="o">,</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">first</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span> <span class="o">:=</span>
<span class="n">rfl</span>
</pre></div>

<h4 id="generic-functions"><a href="#generic-functions" class="success">6.1.3.1 Generic functions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#generic-functions">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="o">&lt;</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="n">B</span><span class="p">)</span> <span class="p">{}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">A</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="n">B</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="n">A</span><span class="p">;</span>                       <span class="c1">// &quot;x&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:14: 1:15</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="n">B</span><span class="p">;</span>                       <span class="c1">// &quot;y&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:20: 1:21</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">();</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:14: 1:15</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:14: 1:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:20: 1:21</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:20: 1:21</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:26: 1:28</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb4</span><span class="p">];</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">resume</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:1: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb6</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb7</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb8</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>

    <span class="n">bb8</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/1/lib.rs:1:28: 1:28</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">{</span><span class="n">B</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="n">where</span> <span class="n">T</span><span class="o">:</span> <span class="nb">Default</span> <span class="p">{}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span> <span class="n">foo</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">i32</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">promoted0</span><span class="p">;</span>                  <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_4</span><span class="p">);</span>                     <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_3</span> <span class="k">as</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">i32</span><span class="p">]</span> <span class="p">(</span><span class="n">Unsize</span><span class="p">);</span>      <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">foo</span><span class="o">::&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>      <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:13: 3:25</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:26: 3:26</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:26: 3:26</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:26: 3:26</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:11: 3:28</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:28: 3:28</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">promoted0</span> <span class="k">in</span> <span class="n">main</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>               <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="p">[</span><span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">];</span>   <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:18: 3:24</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_1</span><span class="p">;</span>                        <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:3:17: 3:24</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="n">T</span><span class="p">];</span>                    <span class="c1">// &quot;x&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:1:11: 1:12</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:1:11: 1:12</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:1:11: 1:12</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:1:37: 1:39</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:1:39: 1:39</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.1 Generic functions/2/lib.rs:1:39: 1:39</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">core</span><span class="bp">.</span><span class="n">default</span><span class="bp">.</span><span class="n">Default</span> <span class="n">T</span><span class="err">»</span> <span class="o">:</span> <span class="n">core</span><span class="bp">.</span><span class="n">default</span><span class="bp">.</span><span class="n">Default</span> <span class="n">T</span><span class="o">]</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">slice</span> <span class="n">T</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="n">promoted_0</span> <span class="err">←</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="o">[(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)]</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t1</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="n">promoted_0</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">t4</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="n">t3</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="n">i32</span> <span class="o">(</span><span class="bp">@</span><span class="n">core</span><span class="bp">.</span><span class="err">«</span><span class="n">i32</span> <span class="n">as</span> <span class="n">core</span><span class="bp">.</span><span class="n">default</span><span class="bp">.</span><span class="n">Default</span><span class="err">»</span><span class="o">)</span> <span class="n">t2</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="diverging-functions"><a href="#diverging-functions" class="success">6.1.3.2 Diverging functions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#diverging-functions">[ref]</a>
</h4>
<p>Divergence is represented as <code>MonadZero.mzero</code> (in the simplest case, <code>none</code>). Because MIR distinguishes between normal and divergent control flow, calls to diverging functions are eagerly replaced by <code>mzero</code> (which of course only works because of the absence of side effects).</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">my_err</span><span class="p">(</span><span class="n">s</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">!</span> <span class="p">{</span>
    <span class="c1">//println!(&quot;{}&quot;, s);</span>
    <span class="n">panic</span><span class="o">!</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">42</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">42</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">my_err</span><span class="p">(</span><span class="s">&quot;Bad number!&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">static</span> <span class="n">my_err</span><span class="o">::</span><span class="n">_FILE_LINE</span><span class="o">:</span> <span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">);</span>     <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="kr">const</span> <span class="s">&quot;ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs&quot;</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">3</span><span class="k">u32</span><span class="p">);</span> <span class="c1">// scope 0 at &lt;panic macros&gt;:5:47: 5:76</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at &lt;panic macros&gt;:5:1: 5:78</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">my_err</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">!</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>                       <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">;</span>                    <span class="c1">// &quot;s&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:1:11: 1:12</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:1:11: 1:12</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:1:11: 1:12</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at &lt;panic macros&gt;:3:1: 6:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at &lt;panic macros&gt;:4:9: 6:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at &lt;panic macros&gt;:6:1: 6:13</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">my_err</span><span class="o">::</span><span class="n">_FILE_LINE</span><span class="p">;</span>        <span class="c1">// scope 1 at &lt;panic macros&gt;:6:1: 6:13</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_6</span><span class="p">);</span>                     <span class="c1">// scope 1 at &lt;panic macros&gt;:6:1: 6:13</span>
        <span class="n">std</span><span class="o">::</span><span class="n">rt</span><span class="o">::</span><span class="n">begin_panic</span><span class="o">::&lt;&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="o">&gt;</span><span class="p">(</span><span class="kr">const</span> <span class="s">&quot;explicit panic&quot;</span><span class="p">,</span> <span class="n">_5</span><span class="p">);</span> <span class="c1">// scope 1 at &lt;panic macros&gt;:3:1: 6:17</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;i&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:6:6: 6:7</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:6:6: 6:7</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:6:6: 6:7</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:7:8: 7:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:7:8: 7:9</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:7:8: 7:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_4</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">42</span><span class="k">i32</span><span class="p">);</span>        <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:7:8: 7:15</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:7:15: 7:15</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:7:15: 7:15</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:7:5: 12:6</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:8:9: 8:18</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">42</span><span class="k">i32</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:8:16: 8:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:13:2: 13:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:13:2: 13:2</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:11:9: 11:30</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:11:16: 11:29</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:11:16: 11:29</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;Bad number!&quot;</span><span class="p">;</span>       <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:11:16: 11:29</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_11</span><span class="p">);</span>                   <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:11:16: 11:29</span>
        <span class="n">my_err</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs:11:9: 11:30</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">my_err</span><span class="bp">.</span><span class="err">«$</span><span class="bp">_</span><span class="n">FILE_LINE</span><span class="err">»</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">string</span> <span class="bp">×</span> <span class="n">u32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="s2">&quot;ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/6.1.3.2 Diverging functions/lib.rs&quot;</span><span class="o">,</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">nat</span><span class="o">))</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">my_err</span> <span class="o">(</span><span class="n">sₐ</span> <span class="o">:</span> <span class="n">string</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">empty</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">sₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">my_err</span><span class="bp">.</span><span class="err">«$</span><span class="bp">_</span><span class="n">FILE_LINE</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">t6</span><span class="bp">;</span>
<span class="n">mzero</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">f</span> <span class="o">(</span><span class="n">iₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">i</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">iₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="err">«</span><span class="n">i</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">t4</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">42</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t3</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="mi">42</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="s2">&quot;Bad number!&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="n">t11</span><span class="bp">;</span>
<span class="n">mzero</span>
</pre></div>
</div>
</div>
<h4 id="returning-mutable-reference-to-first-argument."><a href="#returning-mutable-reference-to-first-argument." class="success">Returning mutable reference to first argument</a>
</h4>
<p>For now, we assume that mutable reference return values will always point into the first argument. Then the return value can be represented as a <a href="#mutable-borrowing.">lens</a> on that argument. We immediately probe the new lens in order to catch out-of-bounds borrows eagerly.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">xs</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="o">&amp;</span><span class="k">mut</span> <span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>                <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>              <span class="c1">// &quot;xs&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:1:8: 1:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:1:8: 1:10</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:1:8: 1:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:1:36: 3:2</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:2:5: 2:15</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Len</span><span class="p">((</span><span class="o">*</span><span class="n">_2</span><span class="p">));</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:2:10: 2:15</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">,</span> <span class="n">_5</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:2:10: 2:15</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_5</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:2:10: 2:15</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">)[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">];</span>   <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:2:5: 2:15</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:2:5: 2:15</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:1:36: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:3:2: 3:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/7 Returning mutable reference to first argument./lib.rs:3:2: 3:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xsₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">((</span><span class="n">lens</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">)</span> <span class="n">i32</span><span class="o">)</span> <span class="bp">×</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t5</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">(</span><span class="n">lens</span><span class="bp">.</span><span class="n">index</span> <span class="bp">_</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">∘</span><span class="err">ₗ</span> <span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t4</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="o">(</span><span class="n">t4</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t3</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="n">t3</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">ret</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">,</span> <span class="n">xsₐ</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">r</span><span class="bp">.</span><span class="mi">1</span> <span class="o">[</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">]</span> <span class="bp">=</span> <span class="n">return</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">[</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">])</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>

<h4 id="returning-arbitrary-mutable-references."><a href="#returning-arbitrary-mutable-references." class="fail">Returning arbitrary mutable references</a>
</h4>
<p>In general, we would have to return a sum type of lenses that represents which argument the return value points into. The callee would then match on the sum and combine the return value with the corresponding argument lens.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="k">if</span> <span class="o">*</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span> <span class="n">x</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="n">y</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>             <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>             <span class="c1">// &quot;x&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:12: 1:13</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>             <span class="c1">// &quot;y&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:28: 1:29</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:12: 1:13</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:12: 1:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:28: 1:29</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:28: 1:29</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:59: 3:2</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:5: 2:31</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:8: 2:14</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:8: 2:10</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">);</span>                      <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:8: 2:10</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">Gt</span><span class="p">(</span><span class="n">_8</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:8: 2:14</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:14: 2:14</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:14: 2:14</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:5: 2:31</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:17: 2:18</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:5: 2:31</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:26: 2:31</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:28: 2:29</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:26: 2:31</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:31: 2:31</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:5: 2:31</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:2:5: 2:31</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:1:59: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:3:2: 3:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.3 Functions/8 Returning arbitrary mutable references./lib.rs:3:2: 3:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="c">/-</span><span class="cm"> test.foo: unimplemented: returning mutable reference to argument other than the first -/</span>
</pre></div>
</div>
</div>
<h3 id="type-aliases"><a href="#type-aliases" class="success">6.1.4 Type aliases</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#type-aliases">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">type</span> <span class="n">Point</span> <span class="o">=</span> <span class="p">(</span><span class="kt">u8</span><span class="p">,</span> <span class="kt">u8</span><span class="p">);</span>
<span class="kr">const</span> <span class="n">p</span><span class="o">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">68</span><span class="p">);</span>
</pre></div>
<div class="mir"><pre><span class="kr">const</span> <span class="n">p</span><span class="o">:</span> <span class="p">(</span><span class="kt">u8</span><span class="p">,</span> <span class="kt">u8</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">(</span><span class="kt">u8</span><span class="p">,</span> <span class="kt">u8</span><span class="p">);</span>                <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="kr">const</span> <span class="mi">41</span><span class="k">u8</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">68</span><span class="k">u8</span><span class="p">);</span>   <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.4 Type aliases/lib.rs:2:18: 2:26</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.4 Type aliases/lib.rs:2:1: 2:27</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span> <span class="o">:=</span> <span class="o">(</span><span class="n">u8</span> <span class="bp">×</span> <span class="n">u8</span><span class="o">)</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">p</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">u8</span> <span class="bp">×</span> <span class="n">u8</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">((</span><span class="mi">41</span> <span class="o">:</span> <span class="n">nat</span><span class="o">),</span> <span class="o">(</span><span class="mi">68</span> <span class="o">:</span> <span class="n">nat</span><span class="o">))</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="structs"><a href="#structs" class="success">6.1.5 Structs</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#structs">[ref]</a>
</h3>
<p>While MIR prevents us from having to support three different loop constructs, it doesn't help with having to support three different struct constructs.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">Point</span> <span class="p">{</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span> <span class="p">{</span><span class="n">x</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="mi">11</span><span class="p">};</span>
    <span class="kd">let</span> <span class="n">px</span><span class="o">:</span> <span class="kt">i32</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="n">Point</span><span class="p">;</span>                   <span class="c1">// &quot;p&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:4:9: 4:10</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;px&quot; in scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:5:9: 5:11</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:4:9: 4:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Point</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">10</span><span class="k">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">11</span><span class="k">i32</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:4:13: 4:33</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:5:9: 5:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:5:19: 5:22</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:5:19: 5:22</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:5:19: 5:22</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:5:23: 5:23</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:3:11: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/1/lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span>
<span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">11</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">x</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">px</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">Point</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">i32</span><span class="p">);</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
    <span class="kd">let</span> <span class="n">px</span><span class="o">:</span> <span class="kt">i32</span> <span class="o">=</span> <span class="k">match</span> <span class="n">p</span> <span class="p">{</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">x</span> <span class="p">};</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="n">Point</span><span class="p">;</span>                   <span class="c1">// &quot;p&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:4:9: 4:10</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;px&quot; in scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:9: 5:11</span>
        <span class="p">}</span>
        <span class="n">scope</span> <span class="mi">3</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 3 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:35: 5:36</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:4:9: 4:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Point</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}}(</span><span class="kr">const</span> <span class="mi">10</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">11</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:4:13: 4:26</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:9: 5:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:35: 5:36</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:35: 5:36</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 3 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:44: 5:45</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 3 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:44: 5:45</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 3 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:44: 5:45</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 3 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:45: 5:45</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:5:47: 5:47</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:3:11: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/2/lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">inductive</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span> <span class="o">:=</span>
<span class="n">mk</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">i32</span> <span class="bp">→</span> <span class="n">i32</span> <span class="bp">→</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">11</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="k">match</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="k">with</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">mk</span> <span class="n">x0</span> <span class="n">x1</span> <span class="o">:=</span> <span class="n">x0</span> <span class="kn">end</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">px</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">t4</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">Cookie</span><span class="p">;</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">Cookie</span><span class="p">,</span> <span class="n">Cookie</span> <span class="p">{},</span> <span class="n">Cookie</span><span class="p">,</span> <span class="n">Cookie</span> <span class="p">{}];</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="p">[</span><span class="n">Cookie</span><span class="p">;</span> <span class="mi">4</span><span class="p">];</span>             <span class="c1">// &quot;c&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:9: 4:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="n">Cookie</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="n">Cookie</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="n">Cookie</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="n">Cookie</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:9: 4:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:14: 4:20</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">Cookie</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span>    <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:14: 4:20</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:22: 4:31</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">Cookie</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span>    <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:22: 4:31</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:33: 4:39</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">Cookie</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span>    <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:33: 4:39</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:41: 4:50</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Cookie</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span>    <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:41: 4:50</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_2</span><span class="p">,</span> <span class="n">_3</span><span class="p">,</span> <span class="n">_4</span><span class="p">,</span> <span class="n">_5</span><span class="p">];</span>           <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:13: 4:51</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:52: 4:52</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:52: 4:52</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:52: 4:52</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:4:52: 4:52</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:3:11: 5:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:5:2: 5:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.5 Structs/3/lib.rs:5:2: 5:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Cookie</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Cookie</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Cookie</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Cookie</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Cookie</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">c</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="o">[</span><span class="n">t2</span><span class="o">,</span> <span class="n">t3</span><span class="o">,</span> <span class="n">t4</span><span class="o">,</span> <span class="n">t5</span><span class="o">]</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="enumerations"><a href="#enumerations" class="success">6.1.6 Enumerations</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#enumerations">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">enum</span> <span class="n">Animal</span> <span class="p">{</span>
    <span class="n">Dog</span><span class="p">,</span>
    <span class="n">Cat</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">a</span><span class="o">:</span> <span class="n">Animal</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Dog</span><span class="p">;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Cat</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="n">Animal</span><span class="p">;</span>              <span class="c1">// &quot;a&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1/lib.rs:7:9: 7:14</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1/lib.rs:7:9: 7:14</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Dog</span><span class="p">;</span>                <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1/lib.rs:7:25: 7:36</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Cat</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1/lib.rs:8:5: 8:20</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1/lib.rs:6:11: 9:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1/lib.rs:9:2: 9:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1/lib.rs:9:2: 9:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">inductive</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span> <span class="o">:=</span>
<span class="bp">|</span> <span class="n">Dog</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span>
<span class="bp">|</span> <span class="n">Cat</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">discr</span> <span class="o">(</span><span class="n">self</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="o">)</span> <span class="o">:</span> <span class="n">isize</span> <span class="o">:=</span> <span class="k">match</span> <span class="n">self</span> <span class="k">with</span>
<span class="bp">|</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Dog</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Cat</span> <span class="o">:=</span> <span class="mi">1</span>
<span class="kn">end</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">a</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Dog</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">a</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Cat</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="struct-like-enum-variants."><a href="#struct-like-enum-variants." class="success">Struct-like enum variants</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">Name</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">Animal</span> <span class="p">{</span>
    <span class="n">Dog</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="kt">u32</span><span class="p">),</span>
    <span class="n">Cat</span> <span class="p">{</span> <span class="n">name</span><span class="o">:</span> <span class="n">Name</span><span class="p">,</span> <span class="n">weight</span><span class="o">:</span> <span class="kt">u32</span> <span class="p">},</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">a</span><span class="o">:</span> <span class="n">Animal</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Dog</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="mi">37</span><span class="p">);</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Cat</span> <span class="p">{</span> <span class="n">name</span><span class="o">:</span> <span class="n">Name</span><span class="p">,</span> <span class="n">weight</span><span class="o">:</span> <span class="mi">2</span> <span class="p">};</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="n">Animal</span><span class="p">;</span>              <span class="c1">// &quot;a&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:9:9: 9:14</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="n">Name</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="n">Name</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:9:9: 9:14</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:9:37: 9:41</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">Name</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span>      <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:9:37: 9:41</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Dog</span><span class="p">(</span><span class="n">_2</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">37</span><span class="k">u32</span><span class="p">);</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:9:25: 9:46</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:9:47: 9:47</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:10:29: 10:33</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">Name</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span>      <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:10:29: 10:33</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">::</span><span class="n">Cat</span> <span class="p">{</span> <span class="n">name</span><span class="o">:</span> <span class="n">_3</span><span class="p">,</span> <span class="n">weight</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">u32</span> <span class="p">};</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:10:5: 10:46</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:10:47: 10:47</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:8:11: 11:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:11:2: 11:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/1 Struct-like enum variants./lib.rs:11:2: 11:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Name</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>

<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Cat</span><span class="bp">.</span><span class="n">struct</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">name</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Name</span><span class="o">))</span>
<span class="o">(</span><span class="n">weight</span> <span class="o">:</span> <span class="n">u32</span><span class="o">)</span>

<span class="kn">inductive</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span> <span class="o">:=</span>
<span class="bp">|</span> <span class="n">Dog</span> <span class="o">{}</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Name</span><span class="o">)</span> <span class="bp">→</span> <span class="n">u32</span> <span class="bp">→</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span>
<span class="bp">|</span> <span class="n">Cat</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Cat</span><span class="bp">.</span><span class="n">struct</span> <span class="bp">→</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Name</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">a</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Dog</span> <span class="n">t2</span> <span class="o">(</span><span class="mi">37</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Name</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">a</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Cat</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Animal</span><span class="bp">.</span><span class="n">Cat</span><span class="bp">.</span><span class="n">struct</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t3</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">nat</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="enum-discriminants."><a href="#enum-discriminants." class="success">Enum discriminants</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">enum</span> <span class="n">Foo</span> <span class="p">{</span>
    <span class="n">Bar</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">::</span><span class="n">Bar</span> <span class="k">as</span> <span class="kt">u32</span><span class="p">;</span> <span class="c1">// x is now 123u32</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:6:9: 6:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="n">Foo</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:6:9: 6:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:6:13: 6:21</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">::</span><span class="n">Bar</span><span class="p">;</span>                   <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:6:13: 6:21</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">_2</span> <span class="k">as</span> <span class="kt">u32</span> <span class="p">(</span><span class="n">Misc</span><span class="p">);</span>           <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:6:13: 6:28</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:6:29: 6:29</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:5:11: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:7:2: 7:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:7:2: 7:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">Foo</span><span class="o">::</span><span class="n">Bar</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">isize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">isize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">123</span><span class="k">isize</span><span class="p">;</span>             <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:2:11: 2:14</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.6 Enumerations/2 Enum discriminants./lib.rs:2:11: 2:14</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">inductive</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="o">:=</span>
<span class="bp">|</span> <span class="n">Bar</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">discr</span> <span class="o">(</span><span class="n">self</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="o">)</span> <span class="o">:</span> <span class="n">isize</span> <span class="o">:=</span> <span class="k">match</span> <span class="n">self</span> <span class="k">with</span>
<span class="bp">|</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">Bar</span> <span class="o">:=</span> <span class="mi">123</span>
<span class="kn">end</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">Bar</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="n">signed_to_unsigned</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">discr</span> <span class="n">t2</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="constant-items"><a href="#constant-items" class="success">6.1.7 Constant items</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#constant-items">[ref]</a>
</h3>
<p>Constants are fun: If you want to be system-independent, expressions like <code>usize::MAX + 1</code> or <code>1usize &lt;&lt; 33</code> suddenly are not so constant any more. Therefore, we wrap them in the semantics <s>burrito</s> monad.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="kr">const</span> <span class="n">BIT1</span><span class="o">:</span> <span class="kt">u32</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">;</span>
<span class="kr">const</span> <span class="n">BIT2</span><span class="o">:</span> <span class="kt">u32</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>

<span class="kr">const</span> <span class="n">BITS</span><span class="o">:</span> <span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">BIT1</span><span class="p">,</span> <span class="n">BIT2</span><span class="p">];</span>
<span class="kr">const</span> <span class="n">STRING</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="o">=</span> <span class="s">&quot;bitstring&quot;</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">BitsNStrings</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="n">mybits</span><span class="o">:</span> <span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">mystring</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="kt">str</span><span class="p">,</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">BITS_N_STRINGS</span><span class="o">:</span> <span class="n">BitsNStrings</span><span class="o">&lt;</span><span class="nb">&#39;static</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">BitsNStrings</span> <span class="p">{</span>
    <span class="n">mybits</span><span class="o">:</span> <span class="n">BITS</span><span class="p">,</span>
    <span class="n">mystring</span><span class="o">:</span> <span class="n">STRING</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
<div class="mir"><pre><span class="kr">const</span> <span class="n">BITS_N_STRINGS</span><span class="o">:</span> <span class="n">BitsNStrings</span><span class="o">&lt;</span><span class="nb">&#39;static</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="n">BitsNStrings</span><span class="o">&lt;</span><span class="nb">&#39;static</span><span class="o">&gt;</span><span class="p">;</span>   <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">STRING</span><span class="p">;</span>                     <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:14:15: 14:21</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:14:15: 14:21</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">BitsNStrings</span><span class="o">&lt;</span><span class="nb">&#39;static</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">mybits</span><span class="o">:</span> <span class="n">BITS</span><span class="p">,</span> <span class="n">mystring</span><span class="o">:</span> <span class="n">_1</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:12:47: 15:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:12:1: 15:3</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">STRING</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>            <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;bitstring&quot;</span><span class="p">;</span>          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:5:30: 5:41</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:5:1: 5:42</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">BIT2</span><span class="o">:</span> <span class="kt">u32</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">(</span><span class="kt">u32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">CheckedShl</span><span class="p">(</span><span class="kr">const</span> <span class="mi">1</span><span class="k">u32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:2:19: 2:25</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to shift left with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:2:19: 2:25</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">);</span>                <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:2:19: 2:25</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:2:1: 2:26</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">BitsNStrings</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>               <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:8:19: 8:20</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:8:19: 8:20</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">BITS</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>               <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:4:19: 4:20</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:4:19: 4:20</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">BIT1</span><span class="o">:</span> <span class="kt">u32</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">(</span><span class="kt">u32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">CheckedShl</span><span class="p">(</span><span class="kr">const</span> <span class="mi">1</span><span class="k">u32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:1:19: 1:25</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to shift left with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:1:19: 1:25</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">);</span>                <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:1:19: 1:25</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:1:1: 1:26</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">BITS</span><span class="o">:</span> <span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>                <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">BIT1</span><span class="p">,</span> <span class="n">BIT2</span><span class="p">];</span>               <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:4:24: 4:36</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.7 Constant items/1/lib.rs:4:1: 4:37</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">BIT1</span> <span class="o">:</span> <span class="n">sem</span> <span class="n">u32</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">shls</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">BIT2</span> <span class="o">:</span> <span class="n">sem</span> <span class="n">u32</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">shls</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">BITS</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">array</span> <span class="n">u32</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">BIT1</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">BIT2</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">([</span><span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="o">,</span> <span class="err">«$</span><span class="n">tmp1</span><span class="err">»</span><span class="o">])</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">STRING</span> <span class="o">:</span> <span class="n">sem</span> <span class="n">string</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;bitstring&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">BitsNStrings</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">mybits</span> <span class="o">:</span> <span class="o">(</span><span class="n">array</span> <span class="n">u32</span> <span class="mi">2</span><span class="o">))</span>
<span class="o">(</span><span class="n">mystring</span> <span class="o">:</span> <span class="n">string</span><span class="o">)</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">BITS_N_STRINGS</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">BitsNStrings</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">STRING</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="n">t2</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">BITS</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">BitsNStrings</span><span class="bp">.</span><span class="n">mk</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="n">t1</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="static-items"><a href="#static-items" class="success">6.1.8 Static items</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#static-items">[ref]</a>
</h3>
<p>No semantic difference from constants without unsafe code or <code>*Cell</code>s.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">static</span> <span class="n">LEVELS</span><span class="o">:</span> <span class="kt">u32</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
<div class="mir"><pre><span class="k">static</span> <span class="n">LEVELS</span><span class="o">:</span> <span class="kt">u32</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">u32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.8 Static items/2/lib.rs:1:22: 1:23</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.8 Static items/2/lib.rs:1:1: 1:24</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">LEVELS</span> <span class="o">:</span> <span class="n">sem</span> <span class="n">u32</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="traits"><a href="#traits" class="">6.1.9 Traits</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#traits">[ref]</a>
</h3>
<p>Traits, type classes, what's the difference? Well, apart from the implicit <code>Self</code> parameter becoming explicit, we always use explicit calls in the generated code because some Rust types (immutable references, integer types) are translated into the same Lean type, making implicit calls ambiguous. Most proof code should be fine though (see below).</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">Foo</span><span class="p">;</span>

<span class="k">trait</span> <span class="n">Shape</span> <span class="p">{</span> <span class="k">fn</span> <span class="n">area</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span><span class="p">;</span> <span class="p">}</span>
<span class="k">trait</span> <span class="n">Circle</span> <span class="o">:</span> <span class="n">Shape</span> <span class="p">{</span> <span class="k">fn</span> <span class="n">radius</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span><span class="p">;</span> <span class="p">}</span>
<span class="k">impl</span> <span class="n">Shape</span> <span class="k">for</span> <span class="n">Foo</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">area</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span> <span class="p">{</span>
        <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">impl</span> <span class="n">Circle</span> <span class="k">for</span> <span class="n">Foo</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">radius</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span> <span class="p">{</span>
        <span class="c1">//println!(&quot;calling area: {}&quot;, self.area());</span>
        <span class="o">-</span><span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">c</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">;</span>
    <span class="n">c</span><span class="p">.</span><span class="n">radius</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="o">&lt;</span><span class="n">Foo</span> <span class="k">as</span> <span class="n">Circle</span><span class="o">&gt;::</span><span class="n">radius</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Foo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Foo</span><span class="p">;</span>                    <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:11:15: 11:20</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:11:15: 11:20</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:11:15: 11:20</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="o">-</span><span class="mi">1</span><span class="k">i64</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:13:9: 13:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:14:6: 14:6</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:14:6: 14:6</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="o">&lt;</span><span class="n">Foo</span> <span class="k">as</span> <span class="n">Shape</span><span class="o">&gt;::</span><span class="n">area</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Foo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Foo</span><span class="p">;</span>                    <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:6:13: 6:18</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:6:13: 6:18</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:6:13: 6:18</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i64</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:7:9: 7:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:8:6: 8:6</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:8:6: 8:6</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="n">Foo</span><span class="p">;</span>                     <span class="c1">// &quot;c&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:18:9: 18:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Foo</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:18:9: 18:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span>       <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:18:13: 18:16</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:19:5: 19:6</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_1</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:19:5: 19:6</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Foo</span> <span class="k">as</span> <span class="n">Circle</span><span class="o">&gt;::</span><span class="n">radius</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:19:5: 19:15</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:19:16: 19:16</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:17:11: 20:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:20:2: 20:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/1/lib.rs:20:2: 20:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="err">»</span><span class="bp">.</span><span class="n">area</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i64</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Circle</span><span class="err">»</span><span class="bp">.</span><span class="n">radius</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i64</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">area</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i64</span><span class="o">)))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="err">»</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">:=</span> <span class="o">⦃</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="o">),</span>
  <span class="n">area</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="err">»</span><span class="bp">.</span><span class="n">area</span>
<span class="o">⦄</span>

<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Circle</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">Self</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">radius</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i64</span><span class="o">)))</span>

<span class="kn">attribute</span> <span class="o">[</span><span class="kn">coercion</span><span class="o">]</span> <span class="n">test</span><span class="bp">.</span><span class="n">Circle</span><span class="bp">.</span><span class="n">to_Shape</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Circle</span><span class="err">»</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">:=</span> <span class="o">⦃</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">Circle</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="o">),</span>
  <span class="o">(</span><span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="err">»</span><span class="o">),</span>
  <span class="n">radius</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Circle</span><span class="err">»</span><span class="bp">.</span><span class="n">radius</span>
<span class="o">⦄</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">c</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">c</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Circle</span><span class="err">»</span><span class="bp">.</span><span class="n">radius</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">(</span><span class="n">foo</span> <span class="o">:</span> <span class="n">Foo</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">Shape</span><span class="bp">.</span><span class="n">area</span> <span class="n">foo</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">foo</span> <span class="o">:</span> <span class="n">Foo</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">Circle</span><span class="bp">.</span><span class="n">radius</span> <span class="n">foo</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>

<h4 id="generic-traits-and-trait-methods."><a href="#generic-traits-and-trait-methods." class="success">Generic traits and trait methods</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">trait</span> <span class="n">Seq</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">len</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="k">fn</span> <span class="n">elt_at</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">:</span> <span class="kt">u32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">;</span>
    <span class="k">fn</span> <span class="n">iter</span><span class="o">&lt;</span><span class="n">F</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span> <span class="n">where</span> <span class="n">F</span><span class="o">:</span> <span class="nb">Fn</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Seq</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">len</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">u32</span><span class="o">)))</span>
<span class="o">(</span><span class="n">elt_at</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">u32</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">T</span><span class="o">)))</span>
<span class="o">(</span><span class="n">iter</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">Fn</span> <span class="n">F</span> <span class="n">T</span><span class="err">»</span> <span class="o">:</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">Fn</span> <span class="n">F</span> <span class="n">T</span> <span class="n">unit</span><span class="o">],</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">F</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)))</span>
</pre></div>
</div>
</div>
<h4 id="default-methods."><a href="#default-methods." class="success">Default methods</a>
</h4>
<p>Default methods are terrible. They should be part of the type class just like standard methods, but they also depend on the type class in order to call other trait methods, creating a cyclic dependency. For now, we just declare them outside of (after) the type class, which works for all current proofs, but can create problems (see below).</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">trait</span> <span class="n">Foo</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">);</span>
    <span class="k">fn</span> <span class="n">baz</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{</span> <span class="bp">self</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">Bar</span><span class="p">;</span>

<span class="k">impl</span> <span class="n">Foo</span> <span class="k">for</span> <span class="n">Bar</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">Foo</span><span class="o">::</span><span class="n">baz</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">;</span>                   <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:12: 3:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:12: 3:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:12: 3:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:21: 3:25</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:21: 3:25</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Self</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">bar</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:21: 3:31</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:33: 3:33</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:33: 3:33</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:3:33: 3:33</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="o">&lt;</span><span class="n">Bar</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">bar</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">;</span>                    <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:9:12: 9:17</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:9:12: 9:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:9:12: 9:17</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:9:19: 9:21</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:9:21: 9:21</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/2 Default methods./lib.rs:9:21: 9:21</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">bar</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">baz</span> <span class="o">{</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="err">»</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="o">]</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="n">Self</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">bar</span> <span class="n">Self</span> <span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="err">»</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Bar</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Bar</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="err">»</span><span class="bp">.</span><span class="n">bar</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Bar</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Bar</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="err">»</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">:=</span> <span class="o">⦃</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Bar</span><span class="o">),</span>
  <span class="n">bar</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Bar</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="err">»</span><span class="bp">.</span><span class="n">bar</span>
<span class="o">⦄</span>
</pre></div>
</div>
</div>
<h4 id="calling-default-methods-from-inside-the-trait."><a href="#calling-default-methods-from-inside-the-trait." class="fail">Calling default methods from inside the trait</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">trait</span> <span class="n">Foo</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">);</span>
    <span class="k">fn</span> <span class="n">baz</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{</span> <span class="bp">self</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">Bar</span><span class="p">;</span>

<span class="k">impl</span> <span class="n">Foo</span> <span class="k">for</span> <span class="n">Bar</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{</span> <span class="bp">self</span><span class="p">.</span><span class="n">baz</span><span class="p">()</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">Foo</span><span class="o">::</span><span class="n">baz</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">;</span>                   <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:12: 3:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:12: 3:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:12: 3:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:21: 3:25</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:21: 3:25</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Self</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">bar</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:21: 3:31</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:33: 3:33</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:33: 3:33</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:3:33: 3:33</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="o">&lt;</span><span class="n">Bar</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">bar</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">;</span>                    <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:12: 9:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:12: 9:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:12: 9:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:21: 9:25</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:21: 9:25</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Bar</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">baz</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:21: 9:31</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:33: 9:33</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:33: 9:33</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/3 Calling default methods from inside the trait./lib.rs:9:33: 9:33</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">bar</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">baz</span> <span class="o">{</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="err">»</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="o">]</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="n">Self</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">bar</span> <span class="n">Self</span> <span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="err">»</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Bar</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>

<span class="c">/-</span><span class="cm"> unimplemented: circular dependencies: test.«test.Bar as test.Foo», test.«test.Bar as test.Foo».bar</span>

<span class="cm">definition test.«test.Bar as test.Foo» [instance] := ⦃</span>
<span class="cm">  test.Foo (test.Bar),</span>
<span class="cm">  bar := @test.«test.Bar as test.Foo».bar</span>
<span class="cm">⦄</span>

<span class="cm">definition test.«test.Bar as test.Foo».bar (selfₐ : (test.Bar)) : sem (unit) :=</span>
<span class="cm">let&#39; «self$2» ← selfₐ;</span>
<span class="cm">let&#39; t3 ← «self$2»;</span>
<span class="cm">dostep «$tmp» ← @test.Foo.baz (test.Bar) (@test.«test.Bar as test.Foo») t3;</span>
<span class="cm">let&#39; ret ← «$tmp»;</span>
<span class="cm">return (⋆)</span>


<span class="cm">-/</span>
</pre></div>
</div>
</div>
<h4 id="overriding-default-methods."><a href="#overriding-default-methods." class="fail">Overriding default methods</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">trait</span> <span class="n">Foo</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">);</span>
    <span class="k">fn</span> <span class="n">baz</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{</span> <span class="bp">self</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">Bar</span><span class="p">;</span>

<span class="k">impl</span> <span class="n">Foo</span> <span class="k">for</span> <span class="n">Bar</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{}</span>
    <span class="k">fn</span> <span class="n">baz</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="o">&lt;</span><span class="n">Bar</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">baz</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">;</span>                    <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:10:12: 10:17</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:10:12: 10:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:10:12: 10:17</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:10:19: 10:21</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:10:21: 10:21</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:10:21: 10:21</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">Foo</span><span class="o">::</span><span class="n">baz</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">;</span>                   <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:12: 3:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:12: 3:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:12: 3:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:21: 3:25</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:21: 3:25</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Self</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">bar</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:21: 3:31</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:33: 3:33</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:33: 3:33</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:3:33: 3:33</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="o">&lt;</span><span class="n">Bar</span> <span class="k">as</span> <span class="n">Foo</span><span class="o">&gt;::</span><span class="n">bar</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Bar</span><span class="p">;</span>                    <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:9:12: 9:17</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:9:12: 9:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:9:12: 9:17</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:9:19: 9:21</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:9:21: 9:21</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/4 Overriding default methods./lib.rs:9:21: 9:21</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">bar</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">baz</span> <span class="o">{</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="err">»</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="o">]</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="n">Self</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="bp">.</span><span class="n">bar</span> <span class="n">Self</span> <span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Foo</span> <span class="n">Self</span><span class="err">»</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Bar</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Bar</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Foo</span><span class="err">»</span><span class="bp">.</span><span class="n">bar</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Bar</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="c">/-</span><span class="cm"> test.«test.Bar as test.Foo».baz: unimplemented: overriding default method |test.«test.Bar as test.Foo».baz -/</span>

<span class="c">/-</span><span class="cm"> test.«test.Bar as test.Foo»: failed dependencies |test.«test.Bar as test.Foo».baz -/</span>
</pre></div>
</div>
</div>
<h4 id="trait-bounds."><a href="#trait-bounds." class="success">Trait bounds</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">Surface</span> <span class="p">{}</span>
<span class="k">trait</span> <span class="n">Shape</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">draw</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Surface</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">draw_twice</span><span class="o">&lt;</span><span class="n">T</span><span class="o">:</span> <span class="n">Shape</span><span class="o">&gt;</span><span class="p">(</span><span class="n">surface</span><span class="o">:</span> <span class="n">Surface</span><span class="p">,</span> <span class="n">sh</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sh</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="o">&amp;</span><span class="n">surface</span><span class="p">);</span>
    <span class="n">sh</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="o">&amp;</span><span class="n">surface</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">draw_twice</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">Surface</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="n">Surface</span><span class="p">;</span>                 <span class="c1">// &quot;surface&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:25: 6:32</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>                       <span class="c1">// &quot;sh&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:43: 6:45</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Surface</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Surface</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Surface</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Surface</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:25: 6:32</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:25: 6:32</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:43: 6:45</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:43: 6:45</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:5: 7:7</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:5: 7:7</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:13: 7:21</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:13: 7:21</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:13: 7:21</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_9</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:13: 7:21</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">T</span> <span class="k">as</span> <span class="n">Shape</span><span class="o">&gt;::</span><span class="n">draw</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb4</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:5: 7:22</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">resume</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:1: 9:2</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:9:2: 9:2</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:9:2: 9:2</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:23: 7:23</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:23: 7:23</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:7:23: 7:23</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:5: 8:7</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_4</span><span class="p">;</span>                       <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:5: 8:7</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:13: 8:21</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:13: 8:21</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_3</span><span class="p">;</span>                       <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:13: 8:21</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_13</span><span class="p">);</span>                   <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:13: 8:21</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">T</span> <span class="k">as</span> <span class="n">Shape</span><span class="o">&gt;::</span><span class="n">draw</span><span class="p">(</span><span class="n">_11</span><span class="p">,</span> <span class="n">_12</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:5: 8:22</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:23: 8:23</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:23: 8:23</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:8:23: 8:23</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:6:50: 9:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb6</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:9:2: 9:2</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:9:2: 9:2</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:9:2: 9:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:9:2: 9:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/5 Trait bounds./lib.rs:9:2: 9:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Surface</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>


<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">draw</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Surface</span><span class="o">)</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">draw_twice</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">T</span><span class="err">»</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">T</span><span class="o">]</span> <span class="o">(</span><span class="n">surfaceₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Surface</span><span class="o">))</span> <span class="o">(</span><span class="n">shₐ</span> <span class="o">:</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">surface</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">surfaceₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">sh</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">shₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">sh</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">surface</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">t9</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="bp">.</span><span class="n">draw</span> <span class="n">T</span> <span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">T</span><span class="err">»</span> <span class="n">t6</span> <span class="n">t8</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="err">«</span><span class="n">sh</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t13</span> <span class="err">←</span> <span class="err">«</span><span class="n">surface</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="n">t13</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="bp">.</span><span class="n">draw</span> <span class="n">T</span> <span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">T</span><span class="err">»</span> <span class="n">t11</span> <span class="n">t12</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="associated-types."><a href="#associated-types." class="success">Associated types</a>
</h4>
<p>You would think that a language with awesome dependent types like Lean would not have any problem declaring a type as a type class member, and you would be right. What it <em>cannot</em> express, however, are <em>definitional type equalities</em> like in <code>Iterator&lt;Item=T&gt;</code>, which could be written as <code>Iterator::Item ~ T</code> in a more Haskell-y syntax. Therefore, we follow the original paper [1] on associated types in Haskell and desugar them into type parameters. This does weaken type class inference, which is another reason why we don't do that inference in generated code. We might be able to regain inference in a potential future version of Lean that supports functional dependencies.</p>
<p>[1] System F with Type Equality Coercions<br />
Martin Sulzmann, Manuel M. T. Chakravarty, Simon Peyton Jones, and Kevin Donnelly.<br />
In G. Necula, editor, Proceedings of The Third ACM SIGPLAN Workshop on Types in Language Design and Implementation, ACM Press, 2007.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">trait</span> <span class="n">Container</span> <span class="p">{</span>
    <span class="k">type</span> <span class="n">E</span><span class="p">;</span>
    <span class="k">fn</span> <span class="n">empty</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">;</span>
    <span class="k">fn</span> <span class="n">insert</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="bp">self</span><span class="p">,</span> <span class="n">Self</span><span class="o">::</span><span class="n">E</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Container</span> <span class="k">for</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">type</span> <span class="n">E</span> <span class="o">=</span> <span class="n">T</span><span class="p">;</span>
    <span class="k">fn</span> <span class="n">empty</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="p">{</span> <span class="nb">Vec</span><span class="o">::</span><span class="n">new</span><span class="p">()</span> <span class="p">}</span>
    <span class="k">fn</span> <span class="n">insert</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span> <span class="bp">self</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="k">as</span> <span class="n">Container</span><span class="o">&gt;::</span><span class="n">insert</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>   <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:15: 10:24</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>                       <span class="c1">// &quot;x&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:26: 10:27</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:15: 10:24</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:15: 10:24</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:26: 10:27</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:26: 10:27</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:34: 10:38</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:34: 10:38</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:44: 10:45</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:44: 10:45</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">push</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb4</span><span class="p">];</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:34: 10:46</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">resume</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:5: 10:49</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:49: 10:49</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:49: 10:49</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:47: 10:47</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb6</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:47: 10:47</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:47: 10:47</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:47: 10:47</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:32: 10:49</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb7</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:49: 10:49</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb8</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:49: 10:49</span>
    <span class="p">}</span>

    <span class="n">bb8</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:49: 10:49</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:49: 10:49</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:10:49: 10:49</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="k">as</span> <span class="n">Container</span><span class="o">&gt;::</span><span class="n">empty</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>        <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vec</span><span class="o">::</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">new</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:9:28: 9:38</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/6 Associated types./lib.rs:9:40: 9:40</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Container</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">(</span><span class="err">«</span><span class="bp">&lt;</span><span class="n">Self</span> <span class="n">as</span> <span class="n">Container</span><span class="bp">&gt;.</span><span class="n">E</span><span class="err">»</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">empty</span> <span class="o">:</span> <span class="o">(</span><span class="n">sem</span> <span class="o">(</span><span class="n">Self</span><span class="o">)))</span>
<span class="o">(</span><span class="n">insert</span> <span class="o">:</span> <span class="o">(</span><span class="n">Self</span> <span class="bp">→</span> <span class="err">«</span><span class="bp">&lt;</span><span class="n">Self</span> <span class="n">as</span> <span class="n">Container</span><span class="bp">&gt;.</span><span class="n">E</span><span class="err">»</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span> <span class="bp">×</span> <span class="n">Self</span><span class="o">)))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span><span class="bp">&lt;</span><span class="n">T</span><span class="bp">&gt;</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Container</span><span class="err">»</span><span class="bp">.</span><span class="n">empty</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">((</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span> <span class="n">T</span><span class="o">))</span> <span class="o">:=</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="err">«</span><span class="n">Vec</span><span class="bp">&lt;</span><span class="n">T</span><span class="bp">&gt;</span><span class="err">»</span><span class="bp">.</span><span class="n">new</span> <span class="n">T</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span><span class="bp">&lt;</span><span class="n">T</span><span class="bp">&gt;</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Container</span><span class="err">»</span><span class="bp">.</span><span class="n">insert</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span> <span class="n">T</span><span class="o">))</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span> <span class="bp">×</span> <span class="o">(</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span> <span class="n">T</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="o">(</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span> <span class="n">T</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="o">(</span><span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t6</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t6</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="err">«</span><span class="n">Vec</span><span class="bp">&lt;</span><span class="n">T</span><span class="bp">&gt;</span><span class="err">»</span><span class="bp">.</span><span class="n">push</span> <span class="n">T</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="n">t8</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="k">with</span> <span class="o">(</span><span class="n">t5</span><span class="o">,</span> <span class="err">«</span><span class="n">t6</span><span class="err">$»</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="n">selfₐ</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="n">t6</span> <span class="n">selfₐ</span> <span class="err">«</span><span class="n">t6</span><span class="err">$»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">,</span> <span class="n">selfₐ</span><span class="o">)</span>
<span class="kn">end</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span><span class="bp">&lt;</span><span class="n">T</span><span class="bp">&gt;</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Container</span><span class="err">»</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">:=</span> <span class="o">⦃</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">Container</span> <span class="o">(</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span> <span class="n">T</span><span class="o">)</span> <span class="n">T</span><span class="o">,</span>
  <span class="n">empty</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span><span class="bp">&lt;</span><span class="n">T</span><span class="bp">&gt;</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Container</span><span class="err">»</span><span class="bp">.</span><span class="n">empty</span> <span class="n">T</span><span class="o">,</span>
  <span class="n">insert</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">collections</span><span class="bp">.</span><span class="n">vec</span><span class="bp">.</span><span class="n">Vec</span><span class="bp">&lt;</span><span class="n">T</span><span class="bp">&gt;</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Container</span><span class="err">»</span><span class="bp">.</span><span class="n">insert</span> <span class="n">T</span>
<span class="o">⦄</span>
</pre></div>
</div>
</div>
<h4 id="trait-objects."><a href="#trait-objects." class="fail">Trait objects</a>
</h4>
<p>A trait object type <code>&amp;Trait</code> can be interpreted as an existential type <code>∃ (T : Trait), T</code> or, generically for all traits in Lean, as a dependent record</p>
<div class="code"><div class="highlight"><pre><span class="kn">structure</span> <span class="n">trait_obj</span> <span class="o">(</span><span class="n">Trait</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">→</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">:=</span> <span class="c1">-- `Trait` explicitly takes `Self` in Lean</span><br /><span class="o">(</span><span class="n">ActualType</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span><br /><span class="o">(</span><span class="n">impl</span> <span class="o">:</span> <span class="n">Trait</span> <span class="n">ActualType</span><span class="o">)</span><br /><span class="o">(</span><span class="n">self</span> <span class="o">:</span> <span class="n">ActualType</span><span class="o">)</span><br /></pre></div><br /></div>

<p>We could then specify that a trait object indeed implements its trait by generating an instance of type <code>Trait (trait_obj Trait)</code>. The instance would call the respective function on <code>impl</code> with <code>self</code>, and, in the case of <code>&amp;mut self</code> methods, place the new value of <code>self</code> back into the trait object.</p>
<p>However, this wouldn't integrate well (or at all) currently because of technical reasons (<code>trait_obj Trait</code> living in <code>Type₂</code> and Lean's universe hierarchy being noncumulative, if you really want to know), so we simply don't touch that yet.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">trait</span> <span class="n">Shape</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">draw</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>
<span class="k">impl</span> <span class="n">Shape</span> <span class="k">for</span> <span class="kt">i32</span> <span class="p">{</span> <span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">mycircle</span> <span class="o">=</span> <span class="mi">0</span><span class="k">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="n">myshape</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Shape</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">mycircle</span><span class="p">;</span>
    <span class="n">myshape</span><span class="p">.</span><span class="n">draw</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;mycircle&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:7:9: 7:17</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Shape</span><span class="p">;</span>              <span class="c1">// &quot;myshape&quot; in scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:8:9: 8:16</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Shape</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:7:9: 7:17</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:7:20: 7:24</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:8:9: 8:16</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:8:27: 8:36</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:8:27: 8:36</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_1</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:8:27: 8:36</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_4</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:8:27: 8:36</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_3</span> <span class="k">as</span> <span class="o">&amp;</span><span class="n">Shape</span> <span class="p">(</span><span class="n">Unsize</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:8:27: 8:36</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:9:5: 9:12</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:9:5: 9:12</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Shape</span> <span class="k">as</span> <span class="n">Shape</span><span class="o">&gt;::</span><span class="n">draw</span><span class="p">(</span><span class="n">_6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:9:5: 9:19</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:9:20: 9:20</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:6:11: 10:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:10:2: 10:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:10:2: 10:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:10:2: 10:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:10:2: 10:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:10:2: 10:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">Shape</span><span class="o">::</span><span class="n">draw</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Self</span><span class="p">;</span>                   <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:2:13: 2:18</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:2:13: 2:18</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:2:13: 2:18</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:2:20: 2:22</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:2:22: 2:22</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/7 Trait objects./lib.rs:2:22: 2:22</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span> <span class="n">mk</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="bp">.</span><span class="n">draw</span> <span class="o">{</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">Self</span><span class="err">»</span> <span class="o">:</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">Self</span><span class="o">]</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="n">Self</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="c">/-</span><span class="cm"> test.main: unimplemented: trait object -/</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">i32</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span><span class="err">»</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">:=</span> <span class="o">⦃</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">Shape</span> <span class="n">i32</span>
<span class="o">⦄</span>
</pre></div>
</div>
</div>
<h4 id="static-trait-methods."><a href="#static-trait-methods." class="success">Static trait methods</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">trait</span> <span class="n">Num</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">from_i32</span><span class="p">(</span><span class="n">n</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">impl</span> <span class="n">Num</span> <span class="k">for</span> <span class="kt">i64</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">from_i32</span><span class="p">(</span><span class="n">n</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span> <span class="p">{</span> <span class="n">n</span> <span class="k">as</span> <span class="kt">i64</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i64</span> <span class="o">=</span> <span class="n">Num</span><span class="o">::</span><span class="n">from_i32</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="o">&lt;</span><span class="kt">i64</span> <span class="k">as</span> <span class="n">Num</span><span class="o">&gt;::</span><span class="n">from_i32</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i64</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;n&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:17: 5:18</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:17: 5:18</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:17: 5:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:34: 5:35</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:34: 5:35</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_3</span> <span class="k">as</span> <span class="kt">i64</span> <span class="p">(</span><span class="n">Misc</span><span class="p">);</span>           <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:34: 5:42</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:44: 5:44</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:44: 5:44</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:5:44: 5:44</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:8:9: 8:10</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:8:9: 8:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="kt">i64</span> <span class="k">as</span> <span class="n">Num</span><span class="o">&gt;::</span><span class="n">from_i32</span><span class="p">(</span><span class="kr">const</span> <span class="mi">42</span><span class="k">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:8:18: 8:35</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:7:11: 9:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:9:2: 9:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.9 Traits/8 Static trait methods./lib.rs:9:2: 9:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Num</span> <span class="o">[</span><span class="n">class</span><span class="o">]</span> <span class="o">(</span><span class="n">Self</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">from_i32</span> <span class="o">:</span> <span class="o">(</span><span class="n">i32</span> <span class="bp">→</span> <span class="n">sem</span> <span class="o">(</span><span class="n">Self</span><span class="o">)))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">i64</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Num</span><span class="err">»</span><span class="bp">.</span><span class="n">from_i32</span> <span class="o">(</span><span class="n">nₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i64</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">n</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">nₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">n</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="n">signed_to_signed</span> <span class="n">i64</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t3</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">i64</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Num</span><span class="err">»</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">:=</span> <span class="o">⦃</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">Num</span> <span class="n">i64</span><span class="o">,</span>
  <span class="n">from_i32</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">i64</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Num</span><span class="err">»</span><span class="bp">.</span><span class="n">from_i32</span>
<span class="o">⦄</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="err">«</span><span class="n">i64</span> <span class="n">as</span> <span class="n">test</span><span class="bp">.</span><span class="n">Num</span><span class="err">»</span><span class="bp">.</span><span class="n">from_i32</span> <span class="o">(</span><span class="mi">42</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="implementations"><a href="#implementations" class="success">6.1.10 Implementations</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#implementations">[ref]</a>
</h3>
<h4 id="trait-implementations."><a href="#trait-implementations." class="success">Trait implementations</a>
</h4>
<p>See <a href="#traits">6.1.9 Traits</a>.</p>
<h4 id="that-other-type-of-implementations."><a href="#that-other-type-of-implementations." class="success">That other type of implementations</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">Point</span> <span class="p">{</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">}</span>

<span class="k">impl</span> <span class="n">Point</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">log</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//println!(&quot;Point is at ({}, {})&quot;, self.x, self.y);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">my_point</span> <span class="o">=</span> <span class="n">Point</span> <span class="p">{</span><span class="n">x</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span><span class="mi">11</span><span class="p">};</span>
    <span class="n">my_point</span><span class="p">.</span><span class="n">log</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">Point</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Point</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Point</span><span class="p">;</span>                  <span class="c1">// &quot;self&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:4:12: 4:17</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:4:12: 4:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:4:12: 4:17</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:4:19: 6:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:6:6: 6:6</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:6:6: 6:6</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="n">Point</span><span class="p">;</span>                   <span class="c1">// &quot;my_point&quot; in scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:10:9: 10:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="n">Point</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:10:9: 10:17</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">Point</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">10</span><span class="k">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">11</span><span class="k">i32</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:10:20: 10:39</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:11:5: 11:13</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_1</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:11:5: 11:13</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">Point</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>      <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:11:5: 11:19</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:11:20: 11:20</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:9:11: 12:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:12:2: 12:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.1 Items/6.1.10 Implementations/2 That other type of implementations./lib.rs:12:2: 12:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span>
<span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">log</span> <span class="o">(</span><span class="n">selfₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">self</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">selfₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">my_point</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">11</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">my_point</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">log</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h2 id="attributes"><a href="#attributes" class="success">6.3 Attributes</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#attributes">[ref]</a>
</h2>
<p>Most attributes do not influence the language semantics, so we can ignore them. Except for...</p>
<h3 id="conditional-compilation"><a href="#conditional-compilation" class="success">6.3.8 Conditional compilation</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#conditional-compilation">[ref]</a>
</h3>
<p>Since the verification should not depend on the host system, we skip all items marked with <code>#[cfg(..)]</code> except for the harmless <code>#[cfg(not(test))]</code>. These items instead have to be axiomatized in a sensible way by the user.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="cp">#[cfg(any(unix, windows))]</span>
<span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="p">{}</span>

<span class="cp">#[cfg(all(unix, target_pointer_width = </span><span class="s">&quot;32&quot;</span><span class="cp">))]</span>
<span class="k">fn</span> <span class="n">bar</span><span class="p">()</span> <span class="p">{}</span>

<span class="cp">#[cfg(not(foo))]</span>
<span class="k">fn</span> <span class="n">not_foo</span><span class="p">()</span> <span class="p">{}</span>

<span class="cp">#[cfg(not(test))]</span>
<span class="k">fn</span> <span class="n">not_test</span><span class="p">()</span> <span class="p">{}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">not_foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.3 Attributes/6.3.8 Conditional compilation/lib.rs:8:14: 8:16</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.3 Attributes/6.3.8 Conditional compilation/lib.rs:8:16: 8:16</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.3 Attributes/6.3.8 Conditional compilation/lib.rs:2:10: 2:12</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.3 Attributes/6.3.8 Conditional compilation/lib.rs:2:12: 2:12</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">not_test</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/6 Items And Attributes/6.3 Attributes/6.3.8 Conditional compilation/lib.rs:11:15: 11:17</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/6 Items And Attributes/6.3 Attributes/6.3.8 Conditional compilation/lib.rs:11:17: 11:17</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">not_foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">not_test</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h1 id="statements-and-expressions"><a href="#statements-and-expressions" class="">7 Statements and expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#statements-and-expressions">[ref]</a>
</h1>
<h2 id="statements"><a href="#statements" class="success">7.1 Statements</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#statements">[ref]</a>
</h2>
<h3 id="declaration-statements"><a href="#declaration-statements" class="success">7.1.1 Declaration Statements</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#declaration-statements">[ref]</a>
</h3>
<h4 id="item-declarations"><a href="#item-declarations" class="success">7.1.1.1 Item declarations</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#item-declarations">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="n">bar</span><span class="p">()</span> <span class="p">{}</span>
    <span class="n">bar</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="o">::</span><span class="n">bar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.1 Item declarations/lib.rs:2:14: 2:16</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.1 Item declarations/lib.rs:2:16: 2:16</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">foo</span><span class="o">::</span><span class="n">bar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.1 Item declarations/lib.rs:3:5: 3:10</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.1 Item declarations/lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">bar</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">bar</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="let-statements"><a href="#let-statements" class="success">7.1.1.2 let statements</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#let-statements">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">a</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;a&quot; in scope 1 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:2:9: 2:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:2:9: 2:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:2:13: 2:14</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:3:5: 3:6</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:3:5: 3:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:3:5: 3:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:4:2: 4:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:4:2: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.1 Declaration Statements/7.1.1.2 let statements/lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">a</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="err">«</span><span class="n">a</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t2</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="expression-statements"><a href="#expression-statements" class="success">7.1.2 Expression statements</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#expression-statements">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.2 Expression statements/lib.rs:2:5: 2:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.2 Expression statements/lib.rs:1:10: 3:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.1 Statements/7.1.2 Expression statements/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h2 id="expressions"><a href="#expressions" class="">7.2 Expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#expressions">[ref]</a>
</h2>
<h3 id="literal-expressions"><a href="#literal-expressions" class="success">7.2.1 Literal expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#literal-expressions">[ref]</a>
</h3>
<p>Lean3 will have support for <code>char</code> literals! Exciting!</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">();</span>        <span class="c1">// unit type</span>
    <span class="s">&quot;hello&quot;</span><span class="p">;</span>   <span class="c1">// string type</span>
    <span class="c1">//&#39;5&#39;;       // character type</span>
    <span class="mi">5</span><span class="p">;</span>         <span class="c1">// integer type</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.1 Literal expressions/lib.rs:2:5: 2:7</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;hello&quot;</span><span class="p">;</span>              <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.1 Literal expressions/lib.rs:3:5: 3:12</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">5</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.1 Literal expressions/lib.rs:5:5: 5:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.1 Literal expressions/lib.rs:1:11: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.1 Literal expressions/lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="s2">&quot;hello&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="o">(</span><span class="mi">5</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="tuple-expressions"><a href="#tuple-expressions" class="success">7.2.3 Tuple expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#tuple-expressions">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
    <span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="k">usize</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">i32</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">usize</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">4</span><span class="k">i32</span><span class="p">);</span>   <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/1/lib.rs:2:5: 2:11</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="p">(</span><span class="kr">const</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">4</span><span class="k">usize</span><span class="p">,</span> <span class="kr">const</span> <span class="k">true</span><span class="p">);</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/1/lib.rs:3:5: 3:24</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/1/lib.rs:1:11: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/1/lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="o">((</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="o">(</span><span class="s2">&quot;a&quot;</span><span class="o">,</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">nat</span><span class="o">),</span> <span class="n">tt</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<p>Lean uses the much more satisfying definition of tuples as nested pairs, which has the interesting side-effect of unary tuples not being a thing.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,);</span> <span class="c1">// single-element tuple</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// zero in parentheses</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">,);</span>              <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/2/lib.rs:2:5: 2:9</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/2/lib.rs:3:5: 3:8</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/2/lib.rs:1:11: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.3 Tuple expressions/2/lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="struct-expressions"><a href="#struct-expressions" class="success">7.2.4 Struct expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#struct-expressions">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">Point</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i64</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i64</span> <span class="p">}</span>
    <span class="k">struct</span> <span class="n">NothingInMe</span> <span class="p">{</span> <span class="p">}</span>
    <span class="k">struct</span> <span class="n">TuplePoint</span><span class="p">(</span><span class="kt">i64</span><span class="p">,</span> <span class="kt">i64</span><span class="p">);</span>
    <span class="kn">mod</span> <span class="n">game</span> <span class="p">{</span> <span class="k">pub</span> <span class="k">struct</span> <span class="n">User</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="o">&gt;</span> <span class="p">{</span> <span class="k">pub</span> <span class="n">name</span><span class="o">:</span> <span class="o">&amp;</span><span class="na">&#39;a</span> <span class="kt">str</span><span class="p">,</span> <span class="k">pub</span> <span class="n">age</span><span class="o">:</span> <span class="kt">u32</span><span class="p">,</span> <span class="k">pub</span> <span class="n">score</span><span class="o">:</span> <span class="kt">usize</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">struct</span> <span class="n">Cookie</span><span class="p">;</span> <span class="k">fn</span> <span class="n">some_fn</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">t</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="p">{}</span>

    <span class="n">Point</span> <span class="p">{</span><span class="n">x</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="mi">20</span><span class="p">};</span>
    <span class="n">NothingInMe</span> <span class="p">{};</span>
    <span class="n">TuplePoint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
    <span class="kd">let</span> <span class="n">u</span> <span class="o">=</span> <span class="n">game</span><span class="o">::</span><span class="n">User</span> <span class="p">{</span><span class="n">name</span><span class="o">:</span> <span class="s">&quot;Joe&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">:</span> <span class="mi">35</span><span class="p">,</span> <span class="n">score</span><span class="o">:</span> <span class="mi">100_000</span><span class="p">};</span>
    <span class="n">some_fn</span><span class="o">::&lt;</span><span class="n">Cookie</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Cookie</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">game</span><span class="o">::</span><span class="n">User</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span><span class="p">;</span>    <span class="c1">// &quot;u&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:9: 11:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">Point</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">NothingInMe</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">TuplePoint</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">Cookie</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">Point</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">10</span><span class="k">i64</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">20</span><span class="k">i64</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:8:5: 8:25</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">NothingInMe</span><span class="p">;</span>          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:9:5: 9:19</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">TuplePoint</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}}(</span><span class="kr">const</span> <span class="mi">10</span><span class="k">i64</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">20</span><span class="k">i64</span><span class="p">);</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:10:5: 10:23</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:9: 11:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:31: 11:36</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:31: 11:36</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;Joe&quot;</span><span class="p">;</span>                <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:31: 11:36</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_6</span><span class="p">);</span>                     <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:31: 11:36</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">game</span><span class="o">::</span><span class="n">User</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">name</span><span class="o">:</span> <span class="n">_5</span><span class="p">,</span> <span class="n">age</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">35</span><span class="k">u32</span><span class="p">,</span> <span class="n">score</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">100000</span><span class="k">usize</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:13: 11:62</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:63: 11:63</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:11:63: 11:63</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:12:23: 12:29</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">Cookie</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:12:23: 12:29</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">some_fn</span><span class="o">::&lt;</span><span class="n">main</span><span class="o">::</span><span class="n">Cookie</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:12:5: 12:30</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:12:31: 12:31</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:1:11: 13:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:13:2: 13:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:13:2: 13:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="o">::</span><span class="n">some_fn</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>                       <span class="c1">// &quot;t&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:34: 6:35</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="p">();</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:34: 6:35</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:34: 6:35</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:40: 6:42</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb3</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:42: 6:42</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">resume</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:20: 6:42</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:42: 6:42</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:42: 6:42</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:42: 6:42</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/lib.rs:6:42: 6:42</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">i64</span><span class="o">)</span>
<span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">i64</span><span class="o">)</span>

<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">NothingInMe</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>


<span class="kn">inductive</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">TuplePoint</span> <span class="o">:=</span>
<span class="n">mk</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">i64</span> <span class="bp">→</span> <span class="n">i64</span> <span class="bp">→</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">TuplePoint</span>

<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">game</span><span class="bp">.</span><span class="n">User</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">name</span> <span class="o">:</span> <span class="n">string</span><span class="o">)</span>
<span class="o">(</span><span class="n">age</span> <span class="o">:</span> <span class="n">u32</span><span class="o">)</span>
<span class="o">(</span><span class="n">score</span> <span class="o">:</span> <span class="n">usize</span><span class="o">)</span>

<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Cookie</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">some_fn</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">(</span><span class="n">tₐ</span> <span class="o">:</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">t</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">tₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">20</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">NothingInMe</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">TuplePoint</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">20</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="s2">&quot;Joe&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">t6</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">u</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">game</span><span class="bp">.</span><span class="n">User</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t5</span> <span class="o">(</span><span class="mi">35</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">(</span><span class="mi">100000</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Cookie</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">some_fn</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Cookie</span><span class="o">)</span> <span class="n">t8</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">Point3d</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">z</span><span class="o">:</span> <span class="kt">i32</span> <span class="p">}</span>

    <span class="kd">let</span> <span class="n">base</span> <span class="o">=</span> <span class="n">Point3d</span> <span class="p">{</span><span class="n">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">:</span> <span class="mi">3</span><span class="p">};</span>
    <span class="n">Point3d</span> <span class="p">{</span><span class="n">y</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="p">..</span> <span class="n">base</span><span class="p">};</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">Point3d</span><span class="p">;</span>           <span class="c1">// &quot;base&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/2/lib.rs:4:9: 4:13</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">Point3d</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/2/lib.rs:4:9: 4:13</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">Point3d</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">,</span> <span class="n">z</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">3</span><span class="k">i32</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/2/lib.rs:4:16: 4:42</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">Point3d</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">),</span> <span class="n">y</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">,</span> <span class="n">z</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">10</span><span class="k">i32</span> <span class="p">};</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/2/lib.rs:5:5: 5:35</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/2/lib.rs:1:11: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/2/lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.4 Struct expressions/2/lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point3d</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span>
<span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span>
<span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">base</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point3d</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point3d</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point3d</span><span class="bp">.</span><span class="n">x</span> <span class="err">«</span><span class="n">base</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="o">)</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="block-expressions"><a href="#block-expressions" class="success">7.2.5 Block expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#block-expressions">[ref]</a>
</h3>
<p>Well, that's what we have MIR for.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i32</span> <span class="o">=</span> <span class="p">{</span> <span class="p">;</span> <span class="mi">5</span> <span class="p">};</span>
    <span class="n">x</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:2:9: 2:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:2:9: 2:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">5</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:2:22: 2:23</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:3:5: 3:6</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:3:5: 3:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:3:5: 3:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:4:2: 4:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:4:2: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.5 Block expressions/lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="mi">5</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t2</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="method-call-expressions"><a href="#method-call-expressions" class="success">7.2.6 Method-call expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#method-call-expressions">[ref]</a>
</h3>
<p>See <a href="#traits">6.1.9 Traits</a> and <a href="#implementations">6.1.10 Implementations</a>.</p>
<h3 id="field-expressions"><a href="#field-expressions" class="success">7.2.7 Field expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#field-expressions">[ref]</a>
</h3>
<p>Yes, that's some beautiful tuple struct extraction code.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">Point</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i64</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i64</span> <span class="p">}</span>
    <span class="k">struct</span> <span class="n">TuplePoint</span><span class="p">(</span><span class="kt">i64</span><span class="p">,</span> <span class="kt">i64</span><span class="p">);</span>

    <span class="n">Point</span> <span class="p">{</span><span class="n">x</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="mi">20</span><span class="p">}.</span><span class="n">x</span><span class="p">;</span>
    <span class="n">TuplePoint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">).</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">Point</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i64</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="n">main</span><span class="o">::</span><span class="n">TuplePoint</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:5:5: 5:27</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:5:5: 5:25</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">Point</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">10</span><span class="k">i64</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kr">const</span> <span class="mi">20</span><span class="k">i64</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:5:5: 5:25</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">_3</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i64</span><span class="p">);</span>                <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:5:5: 5:27</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:5:5: 5:27</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:5:28: 5:28</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:5:28: 5:28</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:6:5: 6:25</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:6:5: 6:23</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">main</span><span class="o">::</span><span class="n">TuplePoint</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}}(</span><span class="kr">const</span> <span class="mi">10</span><span class="k">i64</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">20</span><span class="k">i64</span><span class="p">);</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:6:5: 6:23</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">_6</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i64</span><span class="p">);</span>                <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:6:5: 6:25</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_5</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:6:5: 6:25</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:6:26: 6:26</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:6:26: 6:26</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:1:11: 7:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.7 Field expressions/lib.rs:7:2: 7:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">i64</span><span class="o">)</span>
<span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">i64</span><span class="o">)</span>

<span class="kn">inductive</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">TuplePoint</span> <span class="o">:=</span>
<span class="n">mk</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">i64</span> <span class="bp">→</span> <span class="n">i64</span> <span class="bp">→</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">TuplePoint</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">20</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">Point</span><span class="bp">.</span><span class="n">x</span> <span class="n">t3</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="n">t2</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">TuplePoint</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">20</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="k">match</span> <span class="n">t6</span> <span class="k">with</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span><span class="bp">.</span><span class="n">TuplePoint</span><span class="bp">.</span><span class="n">mk</span> <span class="n">x0</span> <span class="n">x1</span> <span class="o">:=</span> <span class="n">x0</span> <span class="kn">end</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="n">t5</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="array-expressions"><a href="#array-expressions" class="success">7.2.8 Array expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#array-expressions">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>
    <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">];</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">;</span> <span class="mi">128</span><span class="p">];</span>              <span class="c1">// array with 128 zeros</span>
    <span class="p">[</span><span class="mi">0</span><span class="k">u8</span><span class="p">,</span> <span class="mi">0</span><span class="k">u8</span><span class="p">,</span> <span class="mi">0</span><span class="k">u8</span><span class="p">,</span> <span class="mi">0</span><span class="k">u8</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="kr">const</span> <span class="n">main</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">128</span><span class="k">usize</span><span class="p">;</span>             <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:4:9: 4:12</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:4:9: 4:12</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">4</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span> <span class="mi">4</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">128</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="p">[</span><span class="kt">u8</span><span class="p">;</span> <span class="mi">4</span><span class="p">];</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="p">[</span><span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">3</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">4</span><span class="k">i32</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:2:5: 2:17</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="p">[</span><span class="kr">const</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="kr">const</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="kr">const</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="kr">const</span> <span class="s">&quot;d&quot;</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:3:5: 3:25</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="p">[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">;</span> <span class="kr">const</span> <span class="mi">128</span><span class="k">usize</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:4:5: 4:13</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="p">[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">u8</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">u8</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">u8</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">u8</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:5:5: 5:25</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:1:11: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.8 Array expressions/lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="o">[(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">int</span><span class="o">)]</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="o">[</span><span class="s2">&quot;a&quot;</span><span class="o">,</span> <span class="s2">&quot;b&quot;</span><span class="o">,</span> <span class="s2">&quot;c&quot;</span><span class="o">,</span> <span class="s2">&quot;d&quot;</span><span class="o">]</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">list</span><span class="bp">.</span><span class="n">replicate</span> <span class="mi">128</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">[(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">),</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">),</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">),</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)]</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="index-expressions"><a href="#index-expressions" class="success">7.2.9 Index expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#index-expressions">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">bar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kd">let</span> <span class="n">y</span> <span class="o">=</span> <span class="p">([</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">])[</span><span class="n">n</span><span class="p">];</span> <span class="c1">// panics</span>
    <span class="n">y</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">bar</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>            <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// &quot;n&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:6:9: 6:10</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>        <span class="c1">// &quot;y&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:9: 7:10</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:6:9: 6:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">10</span><span class="k">usize</span><span class="p">;</span>              <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:6:13: 6:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:9: 7:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:28</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:25</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="p">[</span><span class="kr">const</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="kr">const</span> <span class="s">&quot;b&quot;</span><span class="p">];</span>     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:25</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:26: 7:27</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:26: 7:27</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">Len</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:28</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:28</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_7</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_6</span><span class="p">,</span> <span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:28</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_4</span><span class="p">[</span><span class="n">_5</span><span class="p">];</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:28</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:13: 7:28</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:29: 7:29</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:29: 7:29</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:7:29: 7:29</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:8:5: 8:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:9:2: 9:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:9:2: 9:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:9:2: 9:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">4</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:22</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:19</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="p">[</span><span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">3</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">4</span><span class="k">i32</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:19</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">Len</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                    <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:22</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">,</span> <span class="n">_3</span><span class="p">);</span>       <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:22</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_4</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_3</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:22</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">_2</span><span class="p">[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">];</span>           <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:22</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:2:5: 2:22</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:3:2: 3:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.9 Index expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="o">[(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">int</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">int</span><span class="o">)]</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">t2</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t3</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="err">«</span><span class="o">[</span><span class="n">T</span><span class="o">]</span> <span class="n">as</span> <span class="n">core</span><span class="bp">.</span><span class="n">slice</span><span class="bp">.</span><span class="n">SliceExt</span><span class="err">»</span><span class="bp">.</span><span class="n">get_unchecked</span> <span class="n">t2</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t1</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">bar</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">string</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">n</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">[</span><span class="s2">&quot;a&quot;</span><span class="o">,</span> <span class="s2">&quot;b&quot;</span><span class="o">]</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">n</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="n">t4</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="n">t5</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t6</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="err">«</span><span class="o">[</span><span class="n">T</span><span class="o">]</span> <span class="n">as</span> <span class="n">core</span><span class="bp">.</span><span class="n">slice</span><span class="bp">.</span><span class="n">SliceExt</span><span class="err">»</span><span class="bp">.</span><span class="n">get_unchecked</span> <span class="n">t4</span> <span class="n">t5</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kn">example</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">sem</span><span class="bp">.</span><span class="n">terminates</span> <span class="n">test</span><span class="bp">.</span><span class="n">bar</span> <span class="o">:=</span> <span class="n">id</span>
</pre></div>

<h3 id="range-expressions"><a href="#range-expressions" class="success">7.2.10 Range expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#range-expressions">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">..</span><span class="mi">2</span><span class="p">;</span>   <span class="c1">// std::ops::Range</span>
    <span class="mi">3</span><span class="p">..;</span>    <span class="c1">// std::ops::RangeFrom</span>
    <span class="p">..</span><span class="mi">4</span><span class="p">;</span>    <span class="c1">// std::ops::RangeTo</span>
    <span class="p">..;</span>     <span class="c1">// std::ops::RangeFull</span>

    <span class="c1">// still feature gated</span>
    <span class="c1">// 1...2;   // std::ops::RangeInclusive</span>
    <span class="c1">// ...4;    // std::ops::RangeToInclusive</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">Range</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeFrom</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeTo</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeFull</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:2:5: 2:6</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:2:5: 2:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:2:8: 2:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:2:8: 2:9</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">Range</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">start</span><span class="o">:</span> <span class="n">_2</span><span class="p">,</span> <span class="n">end</span><span class="o">:</span> <span class="n">_3</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:2:5: 2:9</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:2:10: 2:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:2:10: 2:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:3:5: 3:6</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">3</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:3:5: 3:6</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeFrom</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">start</span><span class="o">:</span> <span class="n">_5</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:3:5: 3:8</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:3:9: 3:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:4:7: 4:8</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">4</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:4:7: 4:8</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeTo</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">end</span><span class="o">:</span> <span class="n">_7</span> <span class="p">};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:4:5: 4:8</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:4:9: 4:9</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeFull</span><span class="o">::</span><span class="p">{{</span><span class="n">constructor</span><span class="p">}};</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:5:5: 5:7</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:1:11: 10:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.10 Range expressions/lib.rs:10:2: 10:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t2</span> <span class="err">←</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t1</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">Range</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t2</span> <span class="n">t3</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">RangeFrom</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t5</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">RangeTo</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t7</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">RangeFull</span><span class="bp">.</span><span class="n">mk</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="unary-operator-expressions"><a href="#unary-operator-expressions" class="">7.2.11 Unary operator expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#unary-operator-expressions">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="k">mut</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">,</span> <span class="n">b</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">-</span><span class="n">x</span><span class="p">;</span>
    <span class="o">!</span><span class="n">x</span><span class="p">;</span>
    <span class="o">*</span><span class="n">y</span><span class="p">;</span>
    <span class="o">!</span><span class="n">b</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="n">x</span><span class="p">;</span>
    <span class="o">&amp;</span><span class="k">mut</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">,</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:8: 1:13</span>
        <span class="kd">let</span> <span class="n">_5</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">;</span>                    <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:20: 1:21</span>
        <span class="kd">let</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// &quot;b&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:29: 1:30</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_14</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_15</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_16</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_17</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:8: 1:13</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:8: 1:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:20: 1:21</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:20: 1:21</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:29: 1:30</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:29: 1:30</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:2:6: 2:7</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:2:6: 2:7</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_8</span><span class="p">,</span> <span class="kr">const</span> <span class="o">-</span><span class="mi">2147483648</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:2:5: 2:7</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="n">_9</span><span class="p">,</span> <span class="s">&quot;attempt to negate with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:2:5: 2:7</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">Neg</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:2:5: 2:7</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:2:8: 2:8</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:3:6: 3:7</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:3:6: 3:7</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">Not</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                  <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:3:5: 3:7</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:3:8: 3:8</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:4:5: 4:7</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">_5</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:4:5: 4:7</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">_13</span><span class="p">;</span>                       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:4:5: 4:7</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:4:8: 4:8</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:5:6: 5:7</span>
        <span class="n">_15</span> <span class="o">=</span> <span class="n">_6</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:5:6: 5:7</span>
        <span class="n">_14</span> <span class="o">=</span> <span class="n">Not</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                  <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:5:5: 5:7</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:5:8: 5:8</span>
        <span class="n">_16</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_4</span><span class="p">;</span>                       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:6:5: 6:7</span>
        <span class="n">_17</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">_4</span><span class="p">;</span>                   <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:7:5: 7:11</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:1:38: 8:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:8:2: 8:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:8:2: 8:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:8:2: 8:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/lib.rs:8:2: 8:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">bₐ</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">b</span><span class="err">$</span><span class="mi">6</span><span class="err">»</span> <span class="err">←</span> <span class="n">bₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="n">t8</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="bp">-</span><span class="mi">2147483648</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">checked</span><span class="bp">.</span><span class="n">neg</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t8</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="n">sbitnot</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t11</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t13</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="n">t13</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t15</span> <span class="err">←</span> <span class="err">«</span><span class="n">b</span><span class="err">$</span><span class="mi">6</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t14</span> <span class="err">←</span> <span class="n">bool</span><span class="bp">.</span><span class="n">bnot</span> <span class="n">t15</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t16</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t17</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="n">i32</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t17</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="mutable-borrowing."><a href="#mutable-borrowing." class="">Mutable borrowing</a>
</h4>
<p>A mutable reference points somewhere into a local of type <code>T</code> and can read from and write into that values of type <code>S</code>. We represent this as a <a href="https://github.com/Kha/electrolysis/blob/4d67a73fc8edcb453fe4a80e21ed7286f461ffe4/thys/core/pre.lean#L17-L38"><code>lens T S</code></a> and statically keep track of which local the lens focuses on. The act of mutable borrowing translates to creating a new lens.</p>
<h5 id="basic-borrowing-of-local-paths."><a href="#basic-borrowing-of-local-paths." class="success">Basic borrowing of local paths</a>
</h5>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">S</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="k">mut</span> <span class="n">s</span><span class="o">:</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">s</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="o">*</span><span class="n">p</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="n">S</span><span class="p">;</span>                   <span class="c1">// &quot;s&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:3:8: 3:13</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>            <span class="c1">// &quot;p&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:4:9: 4:10</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:3:8: 3:13</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:3:8: 3:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:4:9: 4:10</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">Len</span><span class="p">((</span><span class="n">_2</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]));</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:4:18: 4:24</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">,</span> <span class="n">_4</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:4:18: 4:24</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_4</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:4:18: 4:24</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="n">_2</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">])[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:4:13: 4:24</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:5:5: 5:7</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">);</span>                      <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:5:5: 5:7</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_6</span><span class="p">;</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:5:5: 5:7</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">S</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>               <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:1:21: 1:22</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Basic borrowing of local paths./lib.rs:1:21: 1:22</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">S</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="o">(</span><span class="n">array</span> <span class="n">i32</span> <span class="mi">2</span><span class="o">))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">sₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">sₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t4</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="n">lens</span><span class="bp">.</span><span class="n">index</span> <span class="bp">_</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">∘</span><span class="err">ₗ</span> <span class="n">lens</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">return</span> <span class="bp">∘</span> <span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">o</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="n">i</span><span class="o">,</span> <span class="n">return</span> <span class="o">⦃</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">),</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">i</span> <span class="o">⦄))</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t6</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">41</span><span class="o">)</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">⦃</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">,</span> <span class="n">x</span> <span class="o">:=</span> <span class="o">[</span><span class="mi">41</span><span class="o">,</span> <span class="mi">42</span><span class="o">]⦄)</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>

<h5 id="reborrowing."><a href="#reborrowing." class="success">Reborrowing</a>
</h5>
<p>Reborrowing means composing a new lens onto the existing one.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">S</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">s</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">s</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="o">*</span><span class="n">p</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">S</span><span class="p">;</span>                  <span class="c1">// &quot;s&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:3:8: 3:9</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>            <span class="c1">// &quot;p&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:4:9: 4:10</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:3:8: 3:9</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:3:8: 3:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:4:9: 4:10</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">Len</span><span class="p">(((</span><span class="o">*</span><span class="n">_2</span><span class="p">).</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]));</span>   <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:4:18: 4:24</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">,</span> <span class="n">_4</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:4:18: 4:24</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_4</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:4:18: 4:24</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">((</span><span class="o">*</span><span class="n">_2</span><span class="p">).</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">])[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:4:13: 4:24</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:5:5: 5:7</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">);</span>                      <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:5:5: 5:7</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_6</span><span class="p">;</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:5:5: 5:7</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">S</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>               <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:1:21: 1:22</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./0 Reborrowing./lib.rs:1:21: 1:22</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">S</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="o">(</span><span class="n">array</span> <span class="n">i32</span> <span class="mi">2</span><span class="o">))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">sₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span> <span class="bp">×</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="n">sₐ</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">((</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="o">))</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t4</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="n">lens</span><span class="bp">.</span><span class="n">index</span> <span class="bp">_</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">∘</span><span class="err">ₗ</span> <span class="n">lens</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">return</span> <span class="bp">∘</span> <span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">o</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="n">i</span><span class="o">,</span> <span class="n">return</span> <span class="o">⦃</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">),</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">i</span> <span class="o">⦄)</span> <span class="bp">∘</span><span class="err">ₗ</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="n">sₐ</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="n">sₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t6</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">,</span> <span class="n">sₐ</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h5 id="nested-storing-of-mut-refs."><a href="#nested-storing-of-mut-refs." class="fail">Nested storing of mut refs</a>
</h5>
<p>Nested storing of <code>&amp;mut</code> makes the static tracking harder.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="k">mut</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="k">mut</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="p">{</span>
        <span class="kd">let</span> <span class="n">rs</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">y</span><span class="p">];</span>
        <span class="o">*</span><span class="n">rs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">x</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:1:8: 1:13</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:1:20: 1:25</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_6</span><span class="o">:</span> <span class="p">[</span><span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>       <span class="c1">// &quot;rs&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:13: 3:15</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:1:8: 1:13</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:1:8: 1:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:1:20: 1:25</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:1:20: 1:25</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:13: 3:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:19: 3:25</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">_3</span><span class="p">;</span>                    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:19: 3:25</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:27: 3:33</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:27: 3:33</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">_4</span><span class="p">;</span>                    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:27: 3:33</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:27: 3:33</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="p">[</span><span class="n">_7</span><span class="p">,</span> <span class="n">_8</span><span class="p">];</span>                   <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:18: 3:34</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:35: 3:35</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:35: 3:35</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:3:35: 3:35</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">Len</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                   <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:4:10: 4:15</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">,</span> <span class="n">_10</span><span class="p">);</span>     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:4:10: 4:15</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_11</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_10</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:4:10: 4:15</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">((</span><span class="o">*</span><span class="n">_6</span><span class="p">[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">]),</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:4:9: 4:20</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_12</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:4:9: 4:20</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">(</span><span class="o">*</span><span class="n">_6</span><span class="p">[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">])</span> <span class="o">=</span> <span class="p">(</span><span class="n">_12</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:4:9: 4:20</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:2:5: 5:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:5:6: 5:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:6:5: 6:6</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:6:5: 6:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_13</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:6:5: 6:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:7:2: 7:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.11 Unary operator expressions/2 Mutable borrowing./2 Nested storing of mut refs./lib.rs:7:2: 7:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="c">/-</span><span class="cm"> test.foo: unimplemented: arbitrary move of &amp;mut | _7 -/</span>
</pre></div>
</div>
</div>
<h3 id="binary-operator-expressions"><a href="#binary-operator-expressions" class="success">7.2.12 Binary operator expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#binary-operator-expressions">[ref]</a>
</h3>
<h4 id="arithmetic-operators"><a href="#arithmetic-operators" class="success">7.2.12.1 Arithmetic operators</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#arithmetic-operators">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">unsigned</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">u32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">u32</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">%</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">signed</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">%</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">signed</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:9:11: 9:12</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:9:19: 9:20</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_14</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_15</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_16</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_17</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_18</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_19</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_20</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_21</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_22</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_23</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_24</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_25</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_26</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_27</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_28</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_29</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_30</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:9:11: 9:12</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:9:11: 9:12</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:9:19: 9:20</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:9:19: 9:20</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:5: 10:6</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:5: 10:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:9: 10:10</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:9: 10:10</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_7</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:5: 10:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_8</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:5: 10:10</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">_8</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:5: 10:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:11: 10:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:10:11: 10:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:5: 11:6</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:5: 11:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:9: 11:10</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:9: 11:10</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">CheckedSub</span><span class="p">(</span><span class="n">_10</span><span class="p">,</span> <span class="n">_11</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:5: 11:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_12</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to subtract with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:5: 11:10</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="p">(</span><span class="n">_12</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:5: 11:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:11: 11:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:11:11: 11:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_14</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:5: 12:6</span>
        <span class="n">_14</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:5: 12:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:9: 12:10</span>
        <span class="n">_15</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:9: 12:10</span>
        <span class="n">_16</span> <span class="o">=</span> <span class="n">CheckedMul</span><span class="p">(</span><span class="n">_14</span><span class="p">,</span> <span class="n">_15</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:5: 12:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_16</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to multiply with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:5: 12:10</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="p">(</span><span class="n">_16</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:5: 12:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:11: 12:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_14</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:12:11: 12:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_18</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:6</span>
        <span class="n">_18</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:9: 13:10</span>
        <span class="n">_19</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:9: 13:10</span>
        <span class="n">_20</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_19</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="n">_20</span><span class="p">,</span> <span class="s">&quot;attempt to divide by zero&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:10</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_21</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_19</span><span class="p">,</span> <span class="kr">const</span> <span class="o">-</span><span class="mi">1</span><span class="k">i32</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:10</span>
        <span class="n">_22</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_18</span><span class="p">,</span> <span class="kr">const</span> <span class="o">-</span><span class="mi">2147483648</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:10</span>
        <span class="n">_23</span> <span class="o">=</span> <span class="n">BitAnd</span><span class="p">(</span><span class="n">_21</span><span class="p">,</span> <span class="n">_22</span><span class="p">);</span>          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="n">_23</span><span class="p">,</span> <span class="s">&quot;attempt to divide with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb5</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:10</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_17</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">_18</span><span class="p">,</span> <span class="n">_19</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:5: 13:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:11: 13:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_18</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:13:11: 13:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_25</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:6</span>
        <span class="n">_25</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_26</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:9: 14:10</span>
        <span class="n">_26</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:9: 14:10</span>
        <span class="n">_27</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_26</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="n">_27</span><span class="p">,</span> <span class="s">&quot;attempt to calculate the remainder with a divisor of zero&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:10</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_28</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_26</span><span class="p">,</span> <span class="kr">const</span> <span class="o">-</span><span class="mi">1</span><span class="k">i32</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:10</span>
        <span class="n">_29</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_25</span><span class="p">,</span> <span class="kr">const</span> <span class="o">-</span><span class="mi">2147483648</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:10</span>
        <span class="n">_30</span> <span class="o">=</span> <span class="n">BitAnd</span><span class="p">(</span><span class="n">_28</span><span class="p">,</span> <span class="n">_29</span><span class="p">);</span>          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="n">_30</span><span class="p">,</span> <span class="s">&quot;attempt to calculate the remainder with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:10</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_24</span> <span class="o">=</span> <span class="n">Rem</span><span class="p">(</span><span class="n">_25</span><span class="p">,</span> <span class="n">_26</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:5: 14:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_26</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:11: 14:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_25</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:14:11: 14:11</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:9:27: 15:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:15:2: 15:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:15:2: 15:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:15:2: 15:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">unsigned</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">u32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">u32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:1:13: 1:14</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:1:21: 1:22</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="p">(</span><span class="kt">u32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="p">(</span><span class="kt">u32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_14</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_15</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_16</span><span class="o">:</span> <span class="p">(</span><span class="kt">u32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_17</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_18</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_19</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_20</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_21</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_22</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_23</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_24</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:1:13: 1:14</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:1:13: 1:14</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:1:21: 1:22</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:1:21: 1:22</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:5: 2:6</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:5: 2:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:9: 2:10</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:9: 2:10</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_7</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:5: 2:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_8</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:5: 2:10</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">_8</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:5: 2:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:11: 2:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:2:11: 2:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:5: 3:6</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:5: 3:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:9: 3:10</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:9: 3:10</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">CheckedSub</span><span class="p">(</span><span class="n">_10</span><span class="p">,</span> <span class="n">_11</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:5: 3:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_12</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to subtract with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:5: 3:10</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="p">(</span><span class="n">_12</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">);</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:5: 3:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:11: 3:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:3:11: 3:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_14</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:5: 4:6</span>
        <span class="n">_14</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:5: 4:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:9: 4:10</span>
        <span class="n">_15</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:9: 4:10</span>
        <span class="n">_16</span> <span class="o">=</span> <span class="n">CheckedMul</span><span class="p">(</span><span class="n">_14</span><span class="p">,</span> <span class="n">_15</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:5: 4:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_16</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to multiply with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:5: 4:10</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="p">(</span><span class="n">_16</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">);</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:5: 4:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:11: 4:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_14</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:4:11: 4:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_18</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:5: 5:6</span>
        <span class="n">_18</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:5: 5:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:9: 5:10</span>
        <span class="n">_19</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:9: 5:10</span>
        <span class="n">_20</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_19</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">u32</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:5: 5:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="n">_20</span><span class="p">,</span> <span class="s">&quot;attempt to divide by zero&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:5: 5:10</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_17</span> <span class="o">=</span> <span class="n">Div</span><span class="p">(</span><span class="n">_18</span><span class="p">,</span> <span class="n">_19</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:5: 5:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:11: 5:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_18</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:5:11: 5:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_22</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:5: 6:6</span>
        <span class="n">_22</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:5: 6:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_23</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:9: 6:10</span>
        <span class="n">_23</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:9: 6:10</span>
        <span class="n">_24</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_23</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">u32</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:5: 6:10</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="n">_24</span><span class="p">,</span> <span class="s">&quot;attempt to calculate the remainder with a divisor of zero&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb5</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:5: 6:10</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_21</span> <span class="o">=</span> <span class="n">Rem</span><span class="p">(</span><span class="n">_22</span><span class="p">,</span> <span class="n">_23</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:5: 6:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_23</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:11: 6:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_22</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:6:11: 6:11</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:1:29: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:7:2: 7:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.1 Arithmetic operators/lib.rs:7:2: 7:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">unsigned</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">u32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">u32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">add</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t6</span> <span class="n">t7</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">t8</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sub</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t10</span> <span class="n">t11</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="n">t12</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t14</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t15</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">mul</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t14</span> <span class="n">t15</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t16</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t13</span> <span class="err">←</span> <span class="n">t16</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t18</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t19</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t20</span> <span class="err">←</span> <span class="n">t19</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">checked</span><span class="bp">.</span><span class="n">div</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t18</span> <span class="n">t19</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t17</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t22</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t23</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t24</span> <span class="err">←</span> <span class="n">t23</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">checked</span><span class="bp">.</span><span class="n">rem</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t22</span> <span class="n">t23</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t21</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">signed</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t6</span> <span class="n">t7</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">t8</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">ssub</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t10</span> <span class="n">t11</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="n">t12</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t14</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t15</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">smul</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t14</span> <span class="n">t15</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t16</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t13</span> <span class="err">←</span> <span class="n">t16</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t18</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t19</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t20</span> <span class="err">←</span> <span class="n">t19</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t21</span> <span class="err">←</span> <span class="n">t19</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t22</span> <span class="err">←</span> <span class="n">t18</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="bp">-</span><span class="mi">2147483648</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t23</span> <span class="err">←</span> <span class="n">band</span> <span class="n">t21</span> <span class="n">t22</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">checked</span><span class="bp">.</span><span class="n">sdiv</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t18</span> <span class="n">t19</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t17</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t25</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t26</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t27</span> <span class="err">←</span> <span class="n">t26</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t28</span> <span class="err">←</span> <span class="n">t26</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t29</span> <span class="err">←</span> <span class="n">t25</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="bp">-</span><span class="mi">2147483648</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t30</span> <span class="err">←</span> <span class="n">band</span> <span class="n">t28</span> <span class="n">t29</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">checked</span><span class="bp">.</span><span class="n">srem</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t25</span> <span class="n">t26</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t24</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="bitwise-operators"><a href="#bitwise-operators" class="success">7.2.12.2 Bitwise operators</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#bitwise-operators">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">unsigned</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">u32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">u32</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">|</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">^</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">signed</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">|</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">^</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="kt">bool</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">|</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">^</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="kt">bool</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:17:9: 17:10</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:17:18: 17:19</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:17:9: 17:10</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:17:9: 17:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:17:18: 17:19</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:17:18: 17:19</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:18:5: 18:6</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:18:5: 18:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:18:9: 18:10</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:18:9: 18:10</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">BitAnd</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_7</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:18:5: 18:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:18:11: 18:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:18:11: 18:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:19:5: 19:6</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:19:5: 19:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:19:9: 19:10</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:19:9: 19:10</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">BitOr</span><span class="p">(</span><span class="n">_9</span><span class="p">,</span> <span class="n">_10</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:19:5: 19:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:19:11: 19:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:19:11: 19:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:20:5: 20:6</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:20:5: 20:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:20:9: 20:10</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:20:9: 20:10</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">BitXor</span><span class="p">(</span><span class="n">_12</span><span class="p">,</span> <span class="n">_13</span><span class="p">);</span>          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:20:5: 20:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:20:11: 20:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:20:11: 20:11</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:17:27: 21:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:21:2: 21:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:21:2: 21:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:21:2: 21:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">signed</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:9:11: 9:12</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:9:19: 9:20</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_14</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_15</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_16</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_17</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_18</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_19</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_20</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_21</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:9:11: 9:12</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:9:11: 9:12</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:9:19: 9:20</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:9:19: 9:20</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:10:5: 10:6</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:10:5: 10:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:10:9: 10:10</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:10:9: 10:10</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">BitAnd</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_7</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:10:5: 10:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:10:11: 10:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:10:11: 10:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:11:5: 11:6</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:11:5: 11:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:11:9: 11:10</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:11:9: 11:10</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">BitOr</span><span class="p">(</span><span class="n">_9</span><span class="p">,</span> <span class="n">_10</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:11:5: 11:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:11:11: 11:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:11:11: 11:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:12:5: 12:6</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:12:5: 12:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:12:9: 12:10</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:12:9: 12:10</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">BitXor</span><span class="p">(</span><span class="n">_12</span><span class="p">,</span> <span class="n">_13</span><span class="p">);</span>          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:12:5: 12:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:12:11: 12:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:12:11: 12:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:5: 13:6</span>
        <span class="n">_15</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:5: 13:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_16</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:10: 13:11</span>
        <span class="n">_16</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:10: 13:11</span>
        <span class="n">_17</span> <span class="o">=</span> <span class="n">CheckedShl</span><span class="p">(</span><span class="n">_15</span><span class="p">,</span> <span class="n">_16</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:5: 13:11</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_17</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to shift left with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:5: 13:11</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_14</span> <span class="o">=</span> <span class="p">(</span><span class="n">_17</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:5: 13:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_16</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:12: 13:12</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:13:12: 13:12</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:5: 14:6</span>
        <span class="n">_19</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:5: 14:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_20</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:10: 14:11</span>
        <span class="n">_20</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:10: 14:11</span>
        <span class="n">_21</span> <span class="o">=</span> <span class="n">CheckedShr</span><span class="p">(</span><span class="n">_19</span><span class="p">,</span> <span class="n">_20</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:5: 14:11</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_21</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to shift right with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:5: 14:11</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_18</span> <span class="o">=</span> <span class="p">(</span><span class="n">_21</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:5: 14:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_20</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:12: 14:12</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:14:12: 14:12</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:9:27: 15:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:15:2: 15:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:15:2: 15:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:15:2: 15:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">unsigned</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">u32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">u32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:1:13: 1:14</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:1:21: 1:22</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_14</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_15</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_16</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_17</span><span class="o">:</span> <span class="p">(</span><span class="kt">u32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_18</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_19</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_20</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_21</span><span class="o">:</span> <span class="p">(</span><span class="kt">u32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:1:13: 1:14</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:1:13: 1:14</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:1:21: 1:22</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:1:21: 1:22</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:2:5: 2:6</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:2:5: 2:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:2:9: 2:10</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:2:9: 2:10</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">BitAnd</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_7</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:2:5: 2:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:2:11: 2:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:2:11: 2:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:3:5: 3:6</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:3:5: 3:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:3:9: 3:10</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:3:9: 3:10</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">BitOr</span><span class="p">(</span><span class="n">_9</span><span class="p">,</span> <span class="n">_10</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:3:5: 3:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:3:11: 3:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:3:11: 3:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:4:5: 4:6</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:4:5: 4:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:4:9: 4:10</span>
        <span class="n">_13</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:4:9: 4:10</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">BitXor</span><span class="p">(</span><span class="n">_12</span><span class="p">,</span> <span class="n">_13</span><span class="p">);</span>          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:4:5: 4:10</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_13</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:4:11: 4:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:4:11: 4:11</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:5: 5:6</span>
        <span class="n">_15</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:5: 5:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_16</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:10: 5:11</span>
        <span class="n">_16</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:10: 5:11</span>
        <span class="n">_17</span> <span class="o">=</span> <span class="n">CheckedShl</span><span class="p">(</span><span class="n">_15</span><span class="p">,</span> <span class="n">_16</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:5: 5:11</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_17</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to shift left with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:5: 5:11</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_14</span> <span class="o">=</span> <span class="p">(</span><span class="n">_17</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">);</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:5: 5:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_16</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:12: 5:12</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_15</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:5:12: 5:12</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:5: 6:6</span>
        <span class="n">_19</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:5: 6:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_20</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:10: 6:11</span>
        <span class="n">_20</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:10: 6:11</span>
        <span class="n">_21</span> <span class="o">=</span> <span class="n">CheckedShr</span><span class="p">(</span><span class="n">_19</span><span class="p">,</span> <span class="n">_20</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:5: 6:11</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_21</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to shift right with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:5: 6:11</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_18</span> <span class="o">=</span> <span class="p">(</span><span class="n">_21</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">);</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:5: 6:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_20</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:12: 6:12</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:6:12: 6:12</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:1:29: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:7:2: 7:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.2 Bitwise operators/lib.rs:7:2: 7:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">unsigned</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">u32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">u32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">bitand</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t6</span> <span class="n">t7</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">bitor</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t9</span> <span class="n">t10</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t13</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="n">bitxor</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t12</span> <span class="n">t13</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t15</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t16</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">shl</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t15</span> <span class="n">t16</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t17</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t14</span> <span class="err">←</span> <span class="n">t17</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t19</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t20</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">shr</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t19</span> <span class="n">t20</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t21</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t18</span> <span class="err">←</span> <span class="n">t21</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">signed</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">sbitand</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t6</span> <span class="n">t7</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">sbitor</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t9</span> <span class="n">t10</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t13</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="n">sbitxor</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t12</span> <span class="n">t13</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t15</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t16</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sshls</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t15</span> <span class="n">t16</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t17</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t14</span> <span class="err">←</span> <span class="n">t17</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t19</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t20</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sshrs</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t19</span> <span class="n">t20</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t21</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t18</span> <span class="err">←</span> <span class="n">t21</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">bool</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">band</span> <span class="n">t6</span> <span class="n">t7</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">bor</span> <span class="n">t9</span> <span class="n">t10</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t13</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="n">bxor</span> <span class="n">t12</span> <span class="n">t13</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="lazy-boolean-operators"><a href="#lazy-boolean-operators" class="success">7.2.12.3 Lazy boolean operators</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#lazy-boolean-operators">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">||</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:1:9: 1:10</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:1:18: 1:19</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:1:9: 1:10</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:1:9: 1:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:1:18: 1:19</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:1:18: 1:19</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:6</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:6</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb3</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:11</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="kr">const</span> <span class="k">true</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:11</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:11</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="kr">const</span> <span class="kc">false</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:11</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:11</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:10: 2:11</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:10: 2:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:11: 2:11</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:5: 2:11</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:2:12: 2:12</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:6</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:6</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb7</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:11</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="kr">const</span> <span class="k">true</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:11</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb8</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:11</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="kr">const</span> <span class="kc">false</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:11</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb8</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:11</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:10: 3:11</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:10: 3:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:11: 3:11</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb6</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:5: 3:11</span>
    <span class="p">}</span>

    <span class="n">bb8</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:3:12: 3:12</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:1:27: 4:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:4:2: 4:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:4:2: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.3 Lazy boolean operators/lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t6</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t7</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">tt</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t9</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">tt</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t10</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">tt</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">ff</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">ff</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t9</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">tt</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t10</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">tt</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">ff</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">ff</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t9</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">tt</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t10</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">tt</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">ff</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="comparison-operators"><a href="#comparison-operators" class="success">7.2.12.4 Comparison operators</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#comparison-operators">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">bool</span> <span class="p">{</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="p">}</span>
<span class="c1">// etc...</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:8: 1:9</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:16: 1:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:8: 1:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:8: 1:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:16: 1:17</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:16: 1:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:34: 1:35</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:34: 1:35</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:38: 1:39</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:38: 1:39</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:34: 1:39</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:41: 1:41</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:41: 1:41</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:41: 1:41</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:41: 1:41</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.4 Comparison operators/lib.rs:1:41: 1:41</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">bool</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t5</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t6</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="type-cast-expressions"><a href="#type-cast-expressions" class="success">7.2.12.5 Type cast expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#type-cast-expressions">[ref]</a>
</h4>
<h5 id="integral-casts."><a href="#integral-casts." class="success">Integral casts</a>
</h5>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">isize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">u32</span> <span class="p">{</span> <span class="n">x</span> <span class="k">as</span> <span class="kt">u32</span> <span class="p">}</span>
<span class="c1">// etc...</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">isize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">u32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">u32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">isize</span><span class="p">;</span>                   <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:8: 1:9</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">isize</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:8: 1:9</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:8: 1:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:27: 1:28</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:27: 1:28</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_3</span> <span class="k">as</span> <span class="kt">u32</span> <span class="p">(</span><span class="n">Misc</span><span class="p">);</span>           <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:27: 1:35</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:37: 1:37</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:37: 1:37</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/1 Integral casts./lib.rs:1:37: 1:37</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">isize</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">u32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="n">signed_to_unsigned</span> <span class="n">u32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t3</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h5 id="unsize-casts."><a href="#unsize-casts." class="success">Unsize casts</a>
</h5>
<p>A no-op without trait objects and with identifying <code>[T;N]</code> and <code>[T]</code>.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">]</span> <span class="p">{</span> <span class="n">x</span> <span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">]</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">];</span>                  <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>               <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:8: 1:9</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">;</span> <span class="mi">2</span><span class="p">];</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:8: 1:9</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:8: 1:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:34: 1:35</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:34: 1:35</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_3</span> <span class="k">as</span> <span class="o">&amp;</span><span class="p">[</span><span class="kt">u32</span><span class="p">]</span> <span class="p">(</span><span class="n">Unsize</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:34: 1:35</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:37: 1:37</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:37: 1:37</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:37: 1:37</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">foo</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>               <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:18: 1:19</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.5 Type cast expressions/2 Unsize casts./lib.rs:1:18: 1:19</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">array</span> <span class="n">u32</span> <span class="mi">2</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">((</span><span class="n">slice</span> <span class="n">u32</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t3</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="assignment-expressions"><a href="#assignment-expressions" class="success">7.2.12.6 Assignment expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#assignment-expressions">[ref]</a>
</h4>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/lib.rs:2:9: 2:14</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/lib.rs:2:9: 2:14</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/lib.rs:2:17: 2:18</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/lib.rs:3:5: 3:10</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/lib.rs:1:11: 4:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/lib.rs:4:2: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h5 id="assignment-through-lvalue-paths."><a href="#assignment-through-lvalue-paths." class="success">Assignment through lvalue paths</a>
</h5>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">S</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="k">mut</span> <span class="n">s</span><span class="o">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">i</span><span class="o">:</span> <span class="kt">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span> <span class="p">{</span>
    <span class="n">s</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">s</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="n">S</span><span class="p">;</span>                       <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="n">S</span><span class="p">;</span>                   <span class="c1">// &quot;s&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:3:8: 3:13</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// &quot;i&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:3:18: 3:19</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="n">S</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:3:8: 3:13</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:3:8: 3:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:3:18: 3:19</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:3:18: 3:19</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:4:9: 4:10</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:4:9: 4:10</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">Len</span><span class="p">((</span><span class="n">_3</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]));</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:4:5: 4:11</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:4:5: 4:11</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_7</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_6</span><span class="p">,</span> <span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:4:5: 4:11</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">(</span><span class="n">_3</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">])[</span><span class="n">_5</span><span class="p">]</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:4:5: 4:15</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:4:16: 4:16</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:5:5: 5:6</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:5:5: 5:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_8</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:5:5: 5:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">S</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>               <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:1:21: 1:22</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/1 Assignment through lvalue paths./lib.rs:1:21: 1:22</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">S</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="o">(</span><span class="n">array</span> <span class="n">i32</span> <span class="mi">2</span><span class="o">))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">sₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="o">(</span><span class="n">iₐ</span> <span class="o">:</span> <span class="n">usize</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">((</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">sₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">i</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">iₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">i</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="n">t5</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t6</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp2</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">lift_opt</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">update</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="o">)</span> <span class="n">t5</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="o">⦃</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">),</span> <span class="n">x</span> <span class="o">:=</span> <span class="err">«$</span><span class="n">tmp2</span><span class="err">»</span> <span class="o">⦄</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t8</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">s&#39;</span><span class="o">,</span> <span class="n">s&#39;</span> <span class="bp">=</span> <span class="o">⦃</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">,</span> <span class="n">x</span> <span class="o">:=</span> <span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="mi">42</span><span class="o">]⦄)</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">⦃</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">,</span> <span class="n">x</span> <span class="o">:=</span> <span class="o">[</span><span class="mi">41</span><span class="o">,</span> <span class="mi">42</span><span class="o">]⦄</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">example</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">sem</span><span class="bp">.</span><span class="n">terminates</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">⦃</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">,</span> <span class="n">x</span> <span class="o">:=</span> <span class="o">[</span><span class="mi">41</span><span class="o">,</span> <span class="mi">42</span><span class="o">]⦄</span> <span class="mi">2</span><span class="o">)</span> <span class="o">:=</span> <span class="n">id</span>
</pre></div>

<h5 id="assignment-through-mut-refs."><a href="#assignment-through-mut-refs." class="success">Assignment through mut refs</a>
</h5>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">struct</span> <span class="n">S</span> <span class="p">{</span> <span class="n">x</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="k">mut</span> <span class="n">s</span><span class="o">:</span> <span class="n">S</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">p</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">s</span><span class="p">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="n">S</span><span class="p">;</span>                   <span class="c1">// &quot;s&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:3:8: 3:13</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>            <span class="c1">// &quot;p&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:4:9: 4:10</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:3:8: 3:13</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:3:8: 3:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:4:9: 4:10</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">Len</span><span class="p">((</span><span class="n">_2</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">]));</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:4:18: 4:24</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">,</span> <span class="n">_4</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:4:18: 4:24</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_4</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:4:18: 4:24</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="n">_2</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="p">[</span><span class="kt">i32</span><span class="p">;</span> <span class="mi">2</span><span class="p">])[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:4:13: 4:24</span>
        <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">)</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">;</span>              <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:5:5: 5:11</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:3:18: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="n">S</span><span class="o">::</span><span class="p">{{</span><span class="n">initializer</span><span class="p">}}</span><span class="o">:</span> <span class="kt">usize</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>                   <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>               <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:1:21: 1:22</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.12 Binary operator expressions/7.2.12.6 Assignment expressions/3 Assignment through mut refs./lib.rs:1:21: 1:22</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">S</span> <span class="o">:=</span> <span class="n">mk</span> <span class="o">{}</span> <span class="o">::</span>
<span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="o">(</span><span class="n">array</span> <span class="n">i32</span> <span class="mi">2</span><span class="o">))</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">sₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">sₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t4</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="n">lens</span><span class="bp">.</span><span class="n">index</span> <span class="bp">_</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">∘</span><span class="err">ₗ</span> <span class="n">lens</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">return</span> <span class="bp">∘</span> <span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="bp">.</span><span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">o</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">))</span> <span class="n">i</span><span class="o">,</span> <span class="n">return</span> <span class="o">⦃</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">S</span><span class="o">),</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">i</span> <span class="o">⦄))</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="err">«</span><span class="n">p</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">«</span><span class="n">s</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="compound-assignment-expressions"><a href="#compound-assignment-expressions" class="success">7.2.12.7 Compound assignment expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#compound-assignment-expressions">[ref]</a>
</h3>
<p>Desugared in MIR</p>
<h3 id="call-expressions"><a href="#call-expressions" class="success">7.2.14 Call expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#call-expressions">[ref]</a>
</h3>
<p>Calling a function increments the step counter via the <code>dostep</code> notation.</p>
<p>(Yes, that's the actual example from the reference. Though the implementation of <code>add</code> is hidden by default.)</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">}</span>

<span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i32</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="k">i32</span><span class="p">,</span> <span class="mi">2</span><span class="k">i32</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:4:9: 4:10</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:4:9: 4:10</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:4:18: 4:33</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:3:11: 5:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:5:2: 5:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:5:2: 5:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">add</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:8: 1:9</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:16: 1:17</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:8: 1:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:8: 1:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:16: 1:17</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:16: 1:17</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:33: 1:34</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:36: 1:36</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:36: 1:36</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/lib.rs:1:36: 1:36</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">add</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">main</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">add</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="mutable-reference-parameters."><a href="#mutable-reference-parameters." class="success">Mutable reference parameters</a>
</h4>
<p>Passing a mutable reference means reading the current value from the <a href="#borrowing.">lens</a>, then writing back the new value through the lens.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">set</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">*</span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
        <span class="p">;</span> <span class="p">()</span> <span class="c1">// FIXME: removing this line leaves `ret` uninitialized, which sounds at least like &#39;undesired behavior&#39; from MIR</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">set</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">x</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:7:9: 7:14</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:7:9: 7:14</span>
        <span class="n">_1</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:7:17: 7:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:8:9: 8:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:8:9: 8:15</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">_1</span><span class="p">;</span>                    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:8:9: 8:15</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:8:9: 8:15</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">set</span><span class="p">(</span><span class="n">_3</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:8:5: 8:19</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:8:20: 8:20</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:8:20: 8:20</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:9:5: 9:6</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:9:5: 9:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_5</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:9:5: 9:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_1</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:10:2: 10:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:10:2: 10:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:10:2: 10:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">set</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>                <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:1:8: 1:9</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:1:21: 1:22</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:1:8: 1:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:1:8: 1:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:1:21: 1:22</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:1:21: 1:22</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:2:10: 2:11</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:2:10: 2:11</span>
        <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">)</span> <span class="o">=</span> <span class="n">_5</span><span class="p">;</span>                      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:2:5: 2:11</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:3:10: 3:10</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:3:11: 3:13</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:4:2: 4:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:4:2: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/1 Mutable reference parameters./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">set</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span> <span class="bp">×</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="n">i32</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="n">xₐ</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="n">xₐ</span> <span class="n">t5</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">,</span> <span class="n">xₐ</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="n">i32</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t4</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="o">(</span><span class="n">t4</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t3</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t3</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">set</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="k">with</span> <span class="o">(</span><span class="n">t2</span><span class="o">,</span> <span class="err">«</span><span class="n">t3</span><span class="err">$»</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="n">t3</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span> <span class="err">«</span><span class="n">t3</span><span class="err">$»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">1</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t5</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="kn">end</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="bp">=</span> <span class="mi">2</span><span class="o">)</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>

<h4 id="mutable-references-as-return-values."><a href="#mutable-references-as-return-values." class="success">Mutable references as return values</a>
</h4>
<p>We <a href="#returning-mutable-reference-to-first-argument.">know</a> that the return value will be a lens into the first argument, so we compose it with that one's lens. Note that we also get back the new value of the first argument.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">xs</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="o">&amp;</span><span class="k">mut</span> <span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="n">xs</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="p">{</span>
    <span class="o">*</span><span class="n">foo</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>                <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>              <span class="c1">// &quot;xs&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:1:8: 1:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:1:8: 1:10</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:1:8: 1:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:1:36: 3:2</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:2:5: 2:15</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Len</span><span class="p">((</span><span class="o">*</span><span class="n">_2</span><span class="p">));</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:2:10: 2:15</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">,</span> <span class="n">_5</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:2:10: 2:15</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="s">&quot;index out of bounds: the len is {} but the index is {}&quot;</span><span class="p">,</span> <span class="n">_5</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:2:10: 2:15</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">)[</span><span class="kr">const</span> <span class="mi">0</span><span class="k">usize</span><span class="p">];</span>   <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:2:5: 2:15</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:2:5: 2:15</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:1:36: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:3:2: 3:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:3:2: 3:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:3:2: 3:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">bar</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>              <span class="c1">// &quot;xs&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:5:8: 5:10</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:5:8: 5:10</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:5:8: 5:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:6:6: 6:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:6:10: 6:12</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:6:10: 6:12</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:6:6: 6:13</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">(</span><span class="o">*</span><span class="n">_3</span><span class="p">)</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">;</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:6:5: 6:17</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:6:18: 6:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:6:18: 6:18</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:5:24: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:7:2: 7:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.14 Call expressions/2 Mutable references as return values./lib.rs:7:2: 7:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xsₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">((</span><span class="n">lens</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">)</span> <span class="n">i32</span><span class="o">)</span> <span class="bp">×</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">length</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="n">t5</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">(</span><span class="n">lens</span><span class="bp">.</span><span class="n">index</span> <span class="bp">_</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="bp">∘</span><span class="err">ₗ</span> <span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t4</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="o">(</span><span class="n">t4</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t3</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="n">t3</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">ret</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">,</span> <span class="n">xsₐ</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">bar</span> <span class="o">(</span><span class="n">xsₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span> <span class="bp">×</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="o">(</span><span class="n">slice</span> <span class="n">i32</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">(</span><span class="err">«</span><span class="n">xs</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t4</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t4</span> <span class="n">xsₐ</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="k">with</span> <span class="o">(</span><span class="err">«</span><span class="n">t3</span><span class="err">$»</span><span class="o">,</span> <span class="err">«</span><span class="n">t4</span><span class="err">$»</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="n">xsₐ</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="n">t4</span> <span class="n">xsₐ</span> <span class="err">«</span><span class="n">t4</span><span class="err">$»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="o">(</span><span class="err">«</span><span class="n">t3</span><span class="err">$»</span> <span class="bp">∘</span><span class="err">ₗ</span> <span class="n">t4</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="n">xsₐ</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="n">t3</span> <span class="n">xsₐ</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">,</span> <span class="n">xsₐ</span><span class="o">)</span>
<span class="kn">end</span>
</pre></div>
</div>
</div>
<div class="lean"><pre><span class="kn">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span><span class="bp">.</span><span class="n">terminates_with</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">=</span> <span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="n">y</span><span class="o">])</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">bar</span> <span class="o">[</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">])</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>

<h3 id="lambda-expressions"><a href="#lambda-expressions" class="success">7.2.15 Lambda expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#lambda-expressions">[ref]</a>
</h3>
<p>Compiling lambda expressions means creating a closure structure, a function for the lambda body taking that structure (and returning it for <code>FnMut</code>), and implementing the respective Fn trait.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">apply</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">F</span><span class="o">:</span> <span class="nb">FnOnce</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span><span class="o">&gt;</span><span class="p">(</span><span class="n">f</span><span class="o">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">x</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span> <span class="p">{</span>
    <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="n">apply</span><span class="p">(</span><span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="o">::</span><span class="p">{{</span><span class="n">closure</span><span class="p">}}(</span><span class="n">_1</span><span class="o">:</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">6</span><span class="o">:</span><span class="mi">20</span> <span class="n">y</span><span class="o">:&amp;</span><span class="kt">i32</span><span class="p">],</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:12: 6:13</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:12: 6:13</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:12: 6:13</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:15: 6:16</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:15: 6:16</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:19: 6:20</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_1</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">));</span>            <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:19: 6:20</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(</span><span class="n">_4</span><span class="p">,</span> <span class="n">_5</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:15: 6:20</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_6</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:15: 6:20</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">_6</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:15: 6:20</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:20: 6:20</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:20: 6:20</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:20: 6:20</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:20: 6:20</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:5:8: 5:9</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:5:16: 5:17</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">6</span><span class="o">:</span><span class="mi">20</span> <span class="n">y</span><span class="o">:&amp;</span><span class="kt">i32</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:5:8: 5:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:5:8: 5:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:5:16: 5:17</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:5:16: 5:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:11: 6:20</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:11: 6:20</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:11: 6:20</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">6</span><span class="o">:</span><span class="mi">20</span><span class="p">]</span> <span class="p">{</span> <span class="n">y</span><span class="o">:</span> <span class="n">_6</span> <span class="p">};</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:11: 6:20</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:22: 6:23</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:22: 6:23</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">apply</span><span class="o">::&lt;</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">i32</span><span class="p">,</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">6</span><span class="o">:</span><span class="mi">20</span> <span class="n">y</span><span class="o">:&amp;</span><span class="kt">i32</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:6:5: 6:24</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:7:2: 7:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:7:2: 7:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:7:2: 7:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">apply</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">R</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="n">R</span><span class="p">;</span>                       <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="n">F</span><span class="p">;</span>                       <span class="c1">// &quot;f&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:1:35: 1:36</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>                       <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:1:41: 1:42</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="n">F</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">(</span><span class="n">T</span><span class="p">,);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:1:35: 1:36</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:1:35: 1:36</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:1:41: 1:42</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:1:41: 1:42</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:2:5: 2:6</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:2:5: 2:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:2:5: 2:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:2:7: 2:8</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:2:7: 2:8</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="p">(</span><span class="n">_8</span><span class="p">,);</span>                      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:2:5: 2:9</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">F</span> <span class="k">as</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="nb">FnOnce</span><span class="o">&lt;</span><span class="p">(</span><span class="n">T</span><span class="p">,)</span><span class="o">&gt;&gt;::</span><span class="n">call_once</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb8</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb9</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:2:5: 2:9</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">resume</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:1:1: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb5</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb8</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb10</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb7</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb9</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb10</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb11</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb6</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb11</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb12</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb5</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb12</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb13</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb4</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb13</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb14</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb14</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb15</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb15</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb16</span><span class="p">;</span>                <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>

    <span class="n">bb16</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/lib.rs:3:2: 3:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="kp">apply</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnOnce</span> <span class="n">F</span> <span class="n">T</span><span class="err">»</span> <span class="o">:</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnOnce</span> <span class="n">F</span> <span class="n">T</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">fₐ</span> <span class="o">:</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">R</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">fₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="n">t8</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnOnce</span><span class="bp">.</span><span class="n">call_once</span> <span class="n">F</span> <span class="n">T</span> <span class="n">R</span> <span class="err">«</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnOnce</span> <span class="n">F</span> <span class="n">T</span><span class="err">»</span> <span class="n">t5</span> <span class="n">t7</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">section</span>

<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="o">(</span><span class="n">U0</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">val</span> <span class="o">:</span> <span class="n">U0</span><span class="o">)</span>



<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">fn</span> <span class="o">(</span><span class="err">«$</span><span class="n">a1</span><span class="err">»</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="n">i32</span><span class="o">))</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">val</span> <span class="err">«$</span><span class="n">a1</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t4</span> <span class="n">t5</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t6</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>



<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">inst</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">:</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnOnce</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="n">i32</span><span class="o">)</span> <span class="n">i32</span> <span class="n">i32</span> <span class="o">:=</span>
<span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnOnce</span><span class="bp">.</span><span class="n">mk_simple</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">self</span> <span class="n">args</span><span class="o">,</span> <span class="k">let</span><span class="bp">&#39;</span> <span class="n">xₐ</span> <span class="err">←</span> <span class="n">args</span><span class="bp">;</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">fn</span> <span class="n">self</span> <span class="n">xₐ</span>
<span class="o">)</span>

<span class="kn">end</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t6</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="kp">apply</span> <span class="n">i32</span> <span class="n">i32</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">inst</span> <span class="o">)</span> <span class="n">t5</span> <span class="n">t7</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h4 id="mutable-closures."><a href="#mutable-closures." class="success">Mutable closures</a>
</h4>
<p>Mutable closures work out of the box as long as they don't close over mutable references - that would require <a href="#nested-storing-of-mut-refs.">nested storing of <code>&amp;mut</code></a>.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">apply</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">F</span><span class="o">:</span> <span class="nb">FnMut</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">mut</span> <span class="n">f</span><span class="o">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">x</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="k">mut</span> <span class="n">y</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">move</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="p">{</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="p">},</span> <span class="n">x</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="o">::</span><span class="p">{{</span><span class="n">closure</span><span class="p">}}(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="mi">1</span> <span class="n">Mutable</span> <span class="n">closures</span><span class="p">.</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">10</span><span class="o">:</span><span class="mi">6</span> <span class="n">y</span><span class="o">:</span><span class="kt">i32</span><span class="p">],</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:17: 7:18</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:17: 7:18</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:17: 7:18</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(((</span><span class="o">*</span><span class="n">_1</span><span class="p">).</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">),</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:8:9: 8:15</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_4</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:8:9: 8:15</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="p">((</span><span class="o">*</span><span class="n">_1</span><span class="p">).</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">_4</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:8:9: 8:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:9:9: 9:10</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:9:9: 9:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:9:13: 9:14</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="p">((</span><span class="o">*</span><span class="n">_1</span><span class="p">).</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>             <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:9:13: 9:14</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_6</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:9:9: 9:14</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_7</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:9:9: 9:14</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">_7</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:9:9: 9:14</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:10:6: 10:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:10:6: 10:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:10:6: 10:6</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:10:6: 10:6</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:6:8: 6:9</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;y&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:6:16: 6:21</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="mi">1</span> <span class="n">Mutable</span> <span class="n">closures</span><span class="p">.</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">10</span><span class="o">:</span><span class="mi">6</span> <span class="n">y</span><span class="o">:</span><span class="kt">i32</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:6:8: 6:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:6:8: 6:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:6:16: 6:21</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:6:16: 6:21</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:11: 10:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:11: 10:6</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:11: 10:6</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="mi">1</span> <span class="n">Mutable</span> <span class="n">closures</span><span class="p">.</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">10</span><span class="o">:</span><span class="mi">6</span><span class="p">]</span> <span class="p">{</span> <span class="n">y</span><span class="o">:</span> <span class="n">_6</span> <span class="p">};</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:11: 10:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:10:8: 10:9</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:10:8: 10:9</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">apply</span><span class="o">::&lt;</span><span class="kt">i32</span><span class="p">,</span> <span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="k">ref</span><span class="o">/</span><span class="mi">7</span> <span class="n">Statements</span> <span class="n">and</span> <span class="n">expressions</span><span class="o">/</span><span class="mf">7.2</span> <span class="n">Expressions</span><span class="o">/</span><span class="mf">7.2.15</span> <span class="n">Lambda</span> <span class="n">expressions</span><span class="o">/</span><span class="mi">1</span> <span class="n">Mutable</span> <span class="n">closures</span><span class="p">.</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="mi">10</span><span class="o">:</span><span class="mi">6</span> <span class="n">y</span><span class="o">:</span><span class="kt">i32</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:7:5: 10:10</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:11:2: 11:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:11:2: 11:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:11:2: 11:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:11:2: 11:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:11:2: 11:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:11:2: 11:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">apply</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">F</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>                       <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="n">F</span><span class="p">;</span>                   <span class="c1">// &quot;f&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:1:31: 1:36</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>                       <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:1:41: 1:42</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_5</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>                   <span class="c1">// &quot;y&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:9: 2:10</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">F</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="p">(</span><span class="n">T</span><span class="p">,);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">F</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="p">(</span><span class="n">T</span><span class="p">,);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="n">T</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:1:31: 1:36</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:1:31: 1:36</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:1:41: 1:42</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:1:41: 1:42</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:9: 2:10</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:13: 2:14</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">_3</span><span class="p">;</span>                    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:13: 2:14</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:13: 2:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:15: 2:16</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:15: 2:16</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="p">(</span><span class="n">_9</span><span class="p">,);</span>                      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:13: 2:17</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">F</span> <span class="k">as</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="nb">FnMut</span><span class="o">&lt;</span><span class="p">(</span><span class="n">T</span><span class="p">,)</span><span class="o">&gt;&gt;::</span><span class="n">call_mut</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb8</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb9</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:13: 2:17</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">resume</span><span class="p">;</span>                          <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:1:1: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb5</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:18: 2:18</span>
    <span class="p">}</span>

    <span class="n">bb8</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb10</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb7</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:18: 2:18</span>
    <span class="p">}</span>

    <span class="n">bb9</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:18: 2:18</span>
    <span class="p">}</span>

    <span class="n">bb10</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:18: 2:18</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb11</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb6</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:18: 2:18</span>
    <span class="p">}</span>

    <span class="n">bb11</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:18: 2:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:2:18: 2:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:3:5: 3:6</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">_3</span><span class="p">;</span>                   <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:3:5: 3:6</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:3:5: 3:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:3:7: 3:8</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">_5</span><span class="p">;</span>                        <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:3:7: 3:8</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="p">(</span><span class="n">_12</span><span class="p">,);</span>                    <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:3:5: 3:9</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">F</span> <span class="k">as</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="nb">FnMut</span><span class="o">&lt;</span><span class="p">(</span><span class="n">T</span><span class="p">,)</span><span class="o">&gt;&gt;::</span><span class="n">call_mut</span><span class="p">(</span><span class="n">_10</span><span class="p">,</span> <span class="n">_11</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb13</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb15</span><span class="p">];</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:3:5: 3:9</span>
    <span class="p">}</span>

    <span class="n">bb12</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_12</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb5</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb13</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb16</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb14</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb14</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_11</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb12</span><span class="p">;</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb15</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb14</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb16</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_11</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb17</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb12</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb17</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_12</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb18</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb5</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb18</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb19</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb4</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb19</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb20</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb20</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">return</span><span class="o">:</span> <span class="n">bb21</span><span class="p">,</span> <span class="n">unwind</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb21</span><span class="o">:</span> <span class="p">{</span>
        <span class="nb">drop</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb22</span><span class="p">;</span>                <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>

    <span class="n">bb22</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.15 Lambda expressions/1 Mutable closures./lib.rs:4:2: 4:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="kp">apply</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">}</span> <span class="o">[</span><span class="err">«</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span> <span class="n">F</span> <span class="n">T</span><span class="err">»</span> <span class="o">:</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span> <span class="n">F</span> <span class="n">T</span> <span class="n">T</span><span class="o">]</span> <span class="o">(</span><span class="n">fₐ</span> <span class="o">:</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">T</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">fₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="n">F</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t6</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="n">t9</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t6</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span><span class="bp">.</span><span class="n">call_mut</span> <span class="n">F</span> <span class="n">T</span> <span class="n">T</span> <span class="err">«</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span> <span class="n">F</span> <span class="n">T</span><span class="err">»</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="n">t8</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="k">with</span> <span class="o">(</span><span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span><span class="o">,</span> <span class="err">«</span><span class="n">t6</span><span class="err">$»</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="n">t6</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">«</span><span class="n">t6</span><span class="err">$»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="bp">@</span><span class="n">lens</span><span class="bp">.</span><span class="n">id</span> <span class="n">F</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t10</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="n">t12</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">get</span> <span class="n">t10</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span><span class="bp">.</span><span class="n">call_mut</span> <span class="n">F</span> <span class="n">T</span> <span class="n">T</span> <span class="err">«</span><span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span> <span class="n">F</span> <span class="n">T</span><span class="err">»</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="n">t11</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="k">with</span> <span class="o">(</span><span class="n">ret</span><span class="o">,</span> <span class="err">«</span><span class="n">t10</span><span class="err">$»</span><span class="o">)</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">lens</span><span class="bp">.</span><span class="n">set</span> <span class="n">t10</span> <span class="err">«</span><span class="n">f</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">«</span><span class="n">t10</span><span class="err">$»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="kn">end</span>
<span class="kn">end</span>


<span class="kn">section</span>

<span class="kn">structure</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="o">(</span><span class="n">U0</span> <span class="o">:</span> <span class="n">Type₁</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">val</span> <span class="o">:</span> <span class="n">U0</span><span class="o">)</span>



<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">fn</span> <span class="o">(</span><span class="err">«$</span><span class="n">a1</span><span class="err">»</span> <span class="o">:</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="n">i32</span><span class="o">))</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span> <span class="bp">×</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">val</span> <span class="err">«$</span><span class="n">a1</span><span class="err">»</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«$</span><span class="n">a1</span><span class="err">»</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t4</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">val</span> <span class="err">«$</span><span class="n">a1</span><span class="err">»</span><span class="o">)</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="n">t5</span> <span class="n">t6</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t7</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">,</span> <span class="err">«$</span><span class="n">a1</span><span class="err">»</span><span class="o">)</span>



<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">inst</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="o">:</span> <span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="n">i32</span><span class="o">)</span> <span class="n">i32</span> <span class="n">i32</span> <span class="o">:=</span>
<span class="n">core</span><span class="bp">.</span><span class="n">ops</span><span class="bp">.</span><span class="n">FnMut</span><span class="bp">.</span><span class="n">mk_simple</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">self</span> <span class="n">args</span><span class="o">,</span> <span class="k">let</span><span class="bp">&#39;</span> <span class="n">xₐ</span> <span class="err">←</span> <span class="n">args</span><span class="bp">;</span>
  <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">fn</span> <span class="n">self</span> <span class="n">xₐ</span>
<span class="o">)</span>

<span class="kn">end</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">yₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">yₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">mk</span> <span class="n">t6</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="n">dostep</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span> <span class="err">←</span> <span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="kp">apply</span> <span class="n">i32</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span> <span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">closure_13</span><span class="bp">.</span><span class="n">inst</span> <span class="o">)</span> <span class="n">t5</span> <span class="n">t7</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp</span><span class="err">»</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="loops."><a href="#loops." class="">Loops</a>
</h3>
<p>There is no <code>for</code>, <code>while</code>, <code>loop</code>, <code>continue</code>, or <code>break</code> in MIR, just control flow edges. So we search for strongly connected components in the MIR graph (via <a href="https://docs.rs/petgraph/0.4.0/petgraph/algo/fn.kosaraju_scc.html">petgraph</a>), translate them into separate helper definitions, and compute a fixed point (if any) via a generic <a href="https://github.com/Kha/electrolysis/blob/master/thys/loop_combinator.lean">loop combinator</a>.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="k">mut</span> <span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">{</span> <span class="k">continue</span> <span class="p">};</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">};</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:1:8: 1:13</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_13</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_14</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_15</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_16</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_17</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_18</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_19</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_20</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:1:8: 1:13</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:1:8: 1:13</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:5: 7:6</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:11: 2:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:11: 2:12</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:11: 2:12</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">Ne</span><span class="p">(</span><span class="n">_4</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:11: 2:17</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:17: 2:17</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:17: 2:17</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb3</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:5: 7:6</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:5: 7:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:8:2: 8:2</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb10</span><span class="p">;</span>                    <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:8:2: 8:2</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:12: 3:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:12: 3:13</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:12: 3:13</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_8</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:12: 3:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:18: 3:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:18: 3:18</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb4</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb5</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:9: 3:31</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:21: 3:29</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:21: 3:29</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:3:9: 3:31</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:12: 4:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:12: 4:13</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:12: 4:13</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_12</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:12: 4:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:18: 4:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:18: 4:18</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_11</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb6</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb7</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:9: 4:29</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_14</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:21: 4:26</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:21: 4:26</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="p">();</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:4:9: 4:29</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_16</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:12: 5:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_17</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:12: 5:13</span>
        <span class="n">_17</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:12: 5:13</span>
        <span class="n">_16</span> <span class="o">=</span> <span class="nb">Eq</span><span class="p">(</span><span class="n">_17</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">3</span><span class="k">i32</span><span class="p">);</span>       <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:12: 5:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_16</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:18: 5:18</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_17</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:18: 5:18</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_16</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb8</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb9</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:9: 5:30</span>
    <span class="p">}</span>

    <span class="n">bb8</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_19</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:21: 5:27</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:21: 5:27</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:8:2: 8:2</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb10</span><span class="p">;</span>                    <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:21: 5:27</span>
    <span class="p">}</span>

    <span class="n">bb9</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_15</span> <span class="o">=</span> <span class="p">();</span>                        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:5:9: 5:30</span>
        <span class="n">_20</span> <span class="o">=</span> <span class="n">CheckedSub</span><span class="p">(</span><span class="n">_2</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:6:9: 6:15</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_20</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to subtract with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb11</span><span class="p">;</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:6:9: 6:15</span>
    <span class="p">}</span>

    <span class="n">bb10</span><span class="o">:</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:8:2: 8:2</span>
    <span class="p">}</span>

    <span class="n">bb11</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">_20</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:6:9: 6:15</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:18: 7:6</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./lib.rs:2:5: 7:6</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">section</span>
<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">loop_1</span> <span class="o">(</span><span class="n">state__</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">sum</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">(</span><span class="n">unit</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">state__</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t3</span> <span class="err">←</span> <span class="n">t4</span> <span class="bp">≠</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t3</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="n">t8</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t7</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="n">return</span> <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">inl</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="n">t12</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t11</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="kp">do</span> <span class="n">tmp__</span> <span class="err">←</span> <span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">inr</span> <span class="n">tmp__</span><span class="o">)</span><span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t17</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t16</span> <span class="err">←</span> <span class="n">t17</span> <span class="bp">=</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t16</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="kp">do</span> <span class="n">tmp__</span> <span class="err">←</span> <span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">inr</span> <span class="n">tmp__</span><span class="o">)</span><span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t15</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">ssub</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t20</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">t20</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">inl</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="o">)</span>
<span class="k">else</span>
<span class="kp">do</span> <span class="n">tmp__</span> <span class="err">←</span> <span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">sum</span><span class="bp">.</span><span class="n">inr</span> <span class="n">tmp__</span><span class="o">)</span>

<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="n">loop</span> <span class="o">(</span><span class="n">test</span><span class="bp">.</span><span class="n">foo</span><span class="bp">.</span><span class="n">loop_1</span><span class="o">)</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span>

<span class="kn">end</span>
</pre></div>
</div>
</div>
<h4 id="mutable-borrowing-in-loops."><a href="#mutable-borrowing-in-loops." class="fail">Mutable borrowing in loops</a>
</h4>
<p>Basically an instance of <a href="#returning-arbitrary-mutable-references.">Returning arbitrary mutable references</a>.</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="cm">/*</span>
<span class="cm">// would require generalized mutually inductive types</span>
<span class="cm">enum List&lt;T&gt; {</span>
<span class="cm">    Single(T),</span>
<span class="cm">    Cons(T, Box&lt;List&lt;T&gt;&gt;),</span>
<span class="cm">}</span>

<span class="cm">impl&lt;T&gt; List&lt;T&gt; {</span>
<span class="cm">    fn last_mut(&amp;mut self) -&gt; &amp;mut T {</span>
<span class="cm">        let mut xs = self;</span>
<span class="cm">        loop {</span>
<span class="cm">            let tmp = xs;</span>
<span class="cm">            xs = match tmp {</span>
<span class="cm">                &amp;mut List::Single(ref mut x) =&gt; return x,</span>
<span class="cm">                &amp;mut List::Cons(_, ref mut b) =&gt; &amp;mut *b,</span>
<span class="cm">            };</span>
<span class="cm">        }</span>
<span class="cm">    }</span>
<span class="cm">}*/</span>

<span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="k">mut</span> <span class="n">xs</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">loop</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">xs</span><span class="p">;</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">..];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="k">mut</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>          <span class="c1">// &quot;xs&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:21:8: 21:14</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_5</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>          <span class="c1">// &quot;tmp&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:23:13: 23:16</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_3</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="kt">i32</span><span class="p">];</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeFrom</span><span class="o">&lt;</span><span class="kt">usize</span><span class="o">&gt;</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="kt">usize</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:21:8: 21:14</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:21:8: 21:14</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:22:5: 25:6</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:22:5: 25:6</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:23:13: 23:16</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:23:19: 23:21</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:23:19: 23:21</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">_6</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:23:19: 23:21</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:23:22: 23:22</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:14: 24:27</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:19: 24:27</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:19: 24:22</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:19: 24:22</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:23: 24:26</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:23: 24:24</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">2</span><span class="k">usize</span><span class="p">;</span>              <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:23: 24:24</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeFrom</span><span class="o">&lt;</span><span class="kt">usize</span><span class="o">&gt;</span> <span class="p">{</span> <span class="n">start</span><span class="o">:</span> <span class="n">_11</span> <span class="p">};</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:23: 24:26</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="o">&lt;</span><span class="p">[</span><span class="kt">i32</span><span class="p">]</span> <span class="k">as</span> <span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">IndexMut</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">RangeFrom</span><span class="o">&lt;</span><span class="kt">usize</span><span class="o">&gt;&gt;&gt;::</span><span class="n">index_mut</span><span class="p">(</span><span class="n">_9</span><span class="p">,</span> <span class="n">_10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb2</span><span class="p">;</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:19: 24:27</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:14: 24:27</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">(</span><span class="o">*</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:9: 24:27</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:28: 24:28</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:28: 24:28</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:28: 24:28</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_11</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:28: 24:28</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:24:28: 24:28</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:22:10: 25:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:25:6: 25:6</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb1</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.16-20 Loops./1 Mutable borrowing in loops./lib.rs:22:5: 25:6</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="c">/-</span><span class="cm"> test.foo: unimplemented: &amp;mut nested in type -/</span>
</pre></div>
</div>
</div>
<h3 id="if-expressions"><a href="#if-expressions" class="success">7.2.21 if expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#if-expressions">[ref]</a>
</h3>
<p>We currently translate all arms of an <code>if</code> or <code>match</code> separately, which is easy but not ideal if the control flow converges again at a later point (where 'not ideal' is a nice way of saying 'overhead exponential in the number of sequential <code>if</code>s'). It works fine for now, but we should factor out convergence points into separate helper definitions at some point (just as we're already doing for loops).</p>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">b</span><span class="o">:</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">c</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="n">b</span> <span class="p">{</span> <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span> <span class="p">}</span>
    <span class="k">if</span> <span class="n">c</span> <span class="p">{</span> <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span> <span class="p">}</span>
    <span class="n">x</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">foo</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">i32</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// &quot;b&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:1:8: 1:9</span>
        <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>                    <span class="c1">// &quot;c&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:1:17: 1:18</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>             <span class="c1">// &quot;x&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:2:9: 2:14</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="p">();</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_11</span><span class="o">:</span> <span class="p">(</span><span class="kt">i32</span><span class="p">,</span> <span class="kt">bool</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_12</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:1:8: 1:9</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:1:8: 1:9</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:1:17: 1:18</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:1:17: 1:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:2:9: 2:14</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="kr">const</span> <span class="mi">0</span><span class="k">i32</span><span class="p">;</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:2:17: 2:18</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:8: 3:9</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:8: 3:9</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:9: 3:9</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:5: 3:20</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_8</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:12: 3:18</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_8</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:12: 3:18</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:5: 3:20</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:5: 3:20</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">_8</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:12: 3:18</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:3:5: 3:20</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:8: 4:9</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="n">_4</span><span class="p">;</span>                        <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:8: 4:9</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:9: 4:9</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb6</span><span class="p">];</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:5: 4:20</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_11</span> <span class="o">=</span> <span class="n">CheckedAdd</span><span class="p">(</span><span class="n">_5</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">);</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:12: 4:18</span>
        <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">_11</span><span class="p">.</span><span class="mi">1</span><span class="o">:</span> <span class="kt">bool</span><span class="p">),</span> <span class="s">&quot;attempt to add with overflow&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:12: 4:18</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:5: 4:20</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb8</span><span class="p">;</span>                     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:5: 4:20</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">_11</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>               <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:12: 4:18</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb8</span><span class="p">;</span>                     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:4:5: 4:20</span>
    <span class="p">}</span>

    <span class="n">bb8</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:5:5: 5:6</span>
        <span class="n">_12</span> <span class="o">=</span> <span class="n">_5</span><span class="p">;</span>                        <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:5:5: 5:6</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">_12</span><span class="p">;</span>                        <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:5:5: 5:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_12</span><span class="p">);</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:6:2: 6:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:6:2: 6:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.21 if expressions/lib.rs:6:2: 6:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">foo</span> <span class="o">(</span><span class="n">bₐ</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">(</span><span class="n">cₐ</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">i32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">b</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="n">bₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">c</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="n">cₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="err">←</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">b</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t7</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t8</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="err">←</span> <span class="n">t8</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">c</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t10</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="err">←</span> <span class="n">t11</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t12</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t12</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="err">«</span><span class="n">c</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t10</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="n">sem</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">tt</span><span class="o">))</span> <span class="o">(</span><span class="n">checked</span><span class="bp">.</span><span class="n">sadd</span> <span class="n">i32</span><span class="bp">.</span><span class="n">bits</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">))</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t11</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span> <span class="err">←</span> <span class="n">t11</span><span class="bp">.</span><span class="mi">1</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t12</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t12</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">5</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">t12</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
</pre></div>
</div>
</div>
<h3 id="match-expressions"><a href="#match-expressions" class="success">7.2.22 Match expressions</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#match-expressions">[ref]</a>
</h3>
<div>
  <label><input type="checkbox" onchange="toggle_mir(this)">Show MIR</label>
  <div class="code-pair"><div class="rust"><pre><span class="k">fn</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="p">{</span>
    <span class="k">match</span> <span class="n">x</span> <span class="p">{</span>
        <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s">&quot;one&quot;</span><span class="p">,</span>
        <span class="mi">2</span> <span class="o">=&gt;</span> <span class="s">&quot;two&quot;</span><span class="p">,</span>
        <span class="mi">3</span> <span class="o">=&gt;</span> <span class="s">&quot;three&quot;</span><span class="p">,</span>
        <span class="mi">4</span> <span class="o">=&gt;</span> <span class="s">&quot;four&quot;</span><span class="p">,</span>
        <span class="mi">5</span> <span class="o">=&gt;</span> <span class="s">&quot;five&quot;</span><span class="p">,</span>
        <span class="n">_</span> <span class="o">=&gt;</span> <span class="s">&quot;something else&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="p">{</span>
    <span class="k">match</span> <span class="n">x</span> <span class="p">{</span>
        <span class="n">e</span> <span class="o">@</span> <span class="mi">1</span> <span class="p">...</span> <span class="mi">5</span> <span class="o">=&gt;</span> <span class="s">&quot;got a range element&quot;</span><span class="p">,</span>
        <span class="n">_</span> <span class="o">=&gt;</span> <span class="s">&quot;anything&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f3</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">y</span> <span class="o">=</span> <span class="k">match</span> <span class="o">*</span><span class="n">x</span> <span class="p">{</span> <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s">&quot;zero&quot;</span><span class="p">,</span> <span class="n">_</span> <span class="o">=&gt;</span> <span class="s">&quot;some&quot;</span> <span class="p">};</span>
    <span class="kd">let</span> <span class="n">z</span> <span class="o">=</span> <span class="k">match</span> <span class="n">x</span> <span class="p">{</span> <span class="o">&amp;</span><span class="mi">0</span> <span class="o">=&gt;</span> <span class="s">&quot;zero&quot;</span><span class="p">,</span> <span class="n">_</span> <span class="o">=&gt;</span> <span class="s">&quot;some&quot;</span> <span class="p">};</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f4</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="n">message</span> <span class="o">=</span> <span class="k">match</span> <span class="n">x</span> <span class="p">{</span>
        <span class="mi">0</span> <span class="o">|</span> <span class="mi">1</span>  <span class="o">=&gt;</span> <span class="s">&quot;not many&quot;</span><span class="p">,</span>
        <span class="mi">2</span> <span class="p">...</span> <span class="mi">9</span> <span class="o">=&gt;</span> <span class="s">&quot;a few&quot;</span><span class="p">,</span>
        <span class="n">_</span>      <span class="o">=&gt;</span> <span class="s">&quot;lots&quot;</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f5</span><span class="p">(</span><span class="n">x</span><span class="o">:</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">match</span> <span class="n">x</span> <span class="p">{</span>
        <span class="nb">Some</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">=&gt;</span> <span class="nb">Some</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
        <span class="nb">Some</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">None</span><span class="p">,</span>
        <span class="nb">None</span> <span class="o">=&gt;</span> <span class="n">panic</span><span class="o">!</span><span class="p">(),</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="mir"><pre><span class="k">fn</span> <span class="n">f5</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">option</span><span class="o">::</span><span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">option</span><span class="o">::</span><span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">option</span><span class="o">::</span><span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">option</span><span class="o">::</span><span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:32:7: 32:8</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:14: 34:15</span>
        <span class="p">}</span>
        <span class="n">scope</span> <span class="mi">3</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;x&quot; in scope 3 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:35:14: 35:15</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_6</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_7</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_8</span><span class="o">:</span> <span class="o">!</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_9</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">);</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_10</span><span class="o">:</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">);</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:32:7: 32:8</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:32:7: 32:8</span>
        <span class="n">switch</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">None</span><span class="o">:</span> <span class="n">bb2</span><span class="p">,</span> <span class="nb">Some</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:9: 34:16</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:35: 34:36</span>
        <span class="n">_7</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:35: 34:36</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">option</span><span class="o">::</span><span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;::</span><span class="nb">Some</span><span class="p">(</span><span class="n">_7</span><span class="p">,);</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:30: 34:37</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_7</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:37: 34:37</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb5</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:33:5: 37:6</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_8</span><span class="p">);</span>                 <span class="c1">// scope 1 at &lt;panic macros&gt;:3:1: 6:17</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_9</span><span class="p">);</span>                 <span class="c1">// scope 1 at &lt;panic macros&gt;:4:9: 6:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_10</span><span class="p">);</span>                <span class="c1">// scope 1 at &lt;panic macros&gt;:6:1: 6:13</span>
        <span class="n">_10</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">f5</span><span class="o">::</span><span class="n">_FILE_LINE</span><span class="p">;</span>           <span class="c1">// scope 1 at &lt;panic macros&gt;:6:1: 6:13</span>
        <span class="n">_9</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="o">*</span><span class="n">_10</span><span class="p">);</span>                    <span class="c1">// scope 1 at &lt;panic macros&gt;:6:1: 6:13</span>
        <span class="n">std</span><span class="o">::</span><span class="n">rt</span><span class="o">::</span><span class="n">begin_panic</span><span class="o">::&lt;&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="o">&gt;</span><span class="p">(</span><span class="kr">const</span> <span class="s">&quot;explicit panic&quot;</span><span class="p">,</span> <span class="n">_9</span><span class="p">);</span> <span class="c1">// scope 1 at &lt;panic macros&gt;:3:1: 6:17</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:14: 34:15</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="p">((</span><span class="n">_2</span> <span class="k">as</span> <span class="nb">Some</span><span class="p">).</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:14: 34:15</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:20: 34:26</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:20: 34:21</span>
        <span class="n">_6</span> <span class="o">=</span> <span class="n">_3</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:20: 34:21</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Lt</span><span class="p">(</span><span class="n">_6</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">10</span><span class="k">i32</span><span class="p">);</span>        <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:20: 34:26</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_5</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:26: 34:26</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_6</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:26: 34:26</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb4</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:34:20: 34:26</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:35:14: 35:15</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="p">((</span><span class="n">_2</span> <span class="k">as</span> <span class="nb">Some</span><span class="p">).</span><span class="mi">0</span><span class="o">:</span> <span class="kt">i32</span><span class="p">);</span>      <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:35:14: 35:15</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">option</span><span class="o">::</span><span class="nb">Option</span><span class="o">&lt;</span><span class="kt">i32</span><span class="o">&gt;::</span><span class="nb">None</span><span class="p">;</span> <span class="c1">// scope 3 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:35:20: 35:24</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb5</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:33:5: 37:6</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:37:6: 37:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:37:6: 37:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:38:2: 38:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:38:2: 38:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f4</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:24:7: 24:8</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">;</span>                <span class="c1">// &quot;message&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:25:9: 25:16</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:24:7: 24:8</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:24:7: 24:8</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:25:9: 25:16</span>
        <span class="n">switchInt</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="mi">1</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="n">otherwise</span><span class="o">:</span> <span class="n">bb4</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:26:9: 26:10</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;not many&quot;</span><span class="p">;</span>           <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:26:19: 26:29</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:25:19: 29:6</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;a few&quot;</span><span class="p">;</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:27:20: 27:27</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:25:19: 29:6</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;lots&quot;</span><span class="p">;</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:28:19: 28:25</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:25:19: 29:6</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">Le</span><span class="p">(</span><span class="kr">const</span> <span class="mi">2</span><span class="k">i32</span><span class="p">,</span> <span class="n">_2</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:27:9: 27:16</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:27:9: 27:16</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Le</span><span class="p">(</span><span class="n">_2</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">9</span><span class="k">i32</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:27:9: 27:16</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb2</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb3</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:27:9: 27:16</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:24:15: 30:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:30:2: 30:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:30:2: 30:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:30:2: 30:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f1</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>            <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:1:7: 1:8</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:1:7: 1:8</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:1:7: 1:8</span>
        <span class="n">switchInt</span><span class="p">(</span><span class="n">_2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="mi">2</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb2</span><span class="p">,</span> <span class="mi">3</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb3</span><span class="p">,</span> <span class="mi">4</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb4</span><span class="p">,</span> <span class="mi">5</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb5</span><span class="p">,</span> <span class="n">otherwise</span><span class="o">:</span> <span class="n">bb6</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:3:9: 3:10</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;one&quot;</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:3:14: 3:19</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:2:5: 9:6</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;two&quot;</span><span class="p">;</span>                <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:4:14: 4:19</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:2:5: 9:6</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;three&quot;</span><span class="p">;</span>              <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:5:14: 5:21</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:2:5: 9:6</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;four&quot;</span><span class="p">;</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:6:14: 6:20</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:2:5: 9:6</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;five&quot;</span><span class="p">;</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:7:14: 7:20</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:2:5: 9:6</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;something else&quot;</span><span class="p">;</span>     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:8:14: 8:30</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb7</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:2:5: 9:6</span>
    <span class="p">}</span>

    <span class="n">bb7</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:10:2: 10:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:10:2: 10:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">f5</span><span class="o">::</span><span class="n">_FILE_LINE</span><span class="o">:</span> <span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">(</span><span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">,</span> <span class="kt">u32</span><span class="p">);</span>     <span class="c1">// return pointer</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">(</span><span class="kr">const</span> <span class="s">&quot;ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs&quot;</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">36</span><span class="k">u32</span><span class="p">);</span> <span class="c1">// scope 0 at &lt;panic macros&gt;:5:47: 5:76</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 0 at &lt;panic macros&gt;:5:1: 5:78</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f3</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="p">();</span>                      <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">i32</span><span class="p">;</span>                    <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:19:7: 19:8</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">;</span>                <span class="c1">// &quot;y&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:20:9: 20:10</span>
            <span class="n">scope</span> <span class="mi">3</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="n">_4</span><span class="o">:</span> <span class="o">&amp;</span><span class="kt">str</span><span class="p">;</span>            <span class="c1">// &quot;z&quot; in scope 3 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:21:9: 21:10</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:19:7: 19:8</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:19:7: 19:8</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:20:9: 20:10</span>
        <span class="n">switchInt</span><span class="p">((</span><span class="o">*</span><span class="n">_2</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb1</span><span class="p">,</span> <span class="n">otherwise</span><span class="o">:</span> <span class="n">bb2</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:20:24: 20:25</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;zero&quot;</span><span class="p">;</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:20:29: 20:35</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:20:13: 20:50</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;some&quot;</span><span class="p">;</span>               <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:20:42: 20:48</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb3</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:20:13: 20:50</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:21:9: 21:10</span>
        <span class="n">switchInt</span><span class="p">((</span><span class="o">*</span><span class="n">_2</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="k">i32</span><span class="o">:</span> <span class="n">bb4</span><span class="p">,</span> <span class="n">otherwise</span><span class="o">:</span> <span class="n">bb5</span><span class="p">];</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:21:24: 21:25</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;zero&quot;</span><span class="p">;</span>               <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:21:29: 21:35</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span>                     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:21:13: 21:50</span>
    <span class="p">}</span>

    <span class="n">bb5</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;some&quot;</span><span class="p">;</span>               <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:21:42: 21:48</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb6</span><span class="p">;</span>                     <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:21:13: 21:50</span>
    <span class="p">}</span>

    <span class="n">bb6</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="p">();</span>                         <span class="c1">// scope 3 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:19:16: 22:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_4</span><span class="p">);</span>                 <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:22:2: 22:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:22:2: 22:2</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:22:2: 22:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:22:2: 22:2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">f2</span><span class="p">(</span><span class="n">_1</span><span class="o">:</span> <span class="kt">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_0</span><span class="o">:</span> <span class="o">&amp;</span><span class="nb">&#39;static</span> <span class="kt">str</span><span class="p">;</span>            <span class="c1">// return pointer</span>
    <span class="n">scope</span> <span class="mi">1</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="n">_2</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                     <span class="c1">// &quot;x&quot; in scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:12:7: 12:8</span>
        <span class="n">scope</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="n">_3</span><span class="o">:</span> <span class="kt">i32</span><span class="p">;</span>                 <span class="c1">// &quot;e&quot; in scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:9: 14:20</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_4</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>
    <span class="kd">let</span> <span class="k">mut</span> <span class="n">_5</span><span class="o">:</span> <span class="kt">bool</span><span class="p">;</span>

    <span class="n">bb0</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:12:7: 12:8</span>
        <span class="n">_2</span> <span class="o">=</span> <span class="n">_1</span><span class="p">;</span>                         <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:12:7: 12:8</span>
        <span class="n">_4</span> <span class="o">=</span> <span class="n">Le</span><span class="p">(</span><span class="kr">const</span> <span class="mi">1</span><span class="k">i32</span><span class="p">,</span> <span class="n">_2</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:13: 14:20</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb2</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb1</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:13: 14:20</span>
    <span class="p">}</span>

    <span class="n">bb1</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;anything&quot;</span><span class="p">;</span>           <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:15:14: 15:24</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:13:5: 16:6</span>
    <span class="p">}</span>

    <span class="n">bb2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">_5</span> <span class="o">=</span> <span class="n">Le</span><span class="p">(</span><span class="n">_2</span><span class="p">,</span> <span class="kr">const</span> <span class="mi">5</span><span class="k">i32</span><span class="p">);</span>         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:13: 14:20</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="k">true</span><span class="o">:</span> <span class="n">bb3</span><span class="p">,</span> <span class="kc">false</span><span class="o">:</span> <span class="n">bb1</span><span class="p">];</span> <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:13: 14:20</span>
    <span class="p">}</span>

    <span class="n">bb3</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageLive</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:9: 14:20</span>
        <span class="n">_3</span> <span class="o">=</span> <span class="n">_2</span><span class="p">;</span>                         <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:9: 14:20</span>
        <span class="n">_0</span> <span class="o">=</span> <span class="kr">const</span> <span class="s">&quot;got a range element&quot;</span><span class="p">;</span> <span class="c1">// scope 2 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:14:24: 14:45</span>
        <span class="n">goto</span> <span class="o">-&gt;</span> <span class="n">bb4</span><span class="p">;</span>                     <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:13:5: 16:6</span>
    <span class="p">}</span>

    <span class="n">bb4</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_3</span><span class="p">);</span>                 <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:16:6: 16:6</span>
        <span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span>                 <span class="c1">// scope 0 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:17:2: 17:2</span>
        <span class="k">return</span><span class="p">;</span>                          <span class="c1">// scope 1 at ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs:17:2: 17:2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<div class="lean"><pre><span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">f1</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">string</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;one&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;two&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;three&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">4</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;four&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">5</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;five&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;something else&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>

<span class="kn">end</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">f2</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">string</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="bp">≤</span><span class="err">ᵇ</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t4</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="bp">≤</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">5</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t5</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">e</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;got a range element&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;anything&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="s2">&quot;anything&quot;</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">f3</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;zero&quot;</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">z</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;zero&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">z</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;some&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>

<span class="kn">end</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">y</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;some&quot;</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">z</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;zero&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">z</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;some&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>

<span class="kn">end</span>

<span class="kn">end</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">f4</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="n">i32</span><span class="o">)</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">unit</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">message</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;not many&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">message</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;not many&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t4</span> <span class="err">←</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="bp">≤</span><span class="err">ᵇ</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t4</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="bp">≤</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">9</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t5</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">message</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;a few&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">message</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;lots&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>
<span class="k">else</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">message</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="s2">&quot;lots&quot;</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="err">⋆</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="err">⋆</span><span class="o">)</span>

<span class="kn">end</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">f5</span><span class="bp">.</span><span class="err">«$</span><span class="bp">_</span><span class="n">FILE_LINE</span><span class="err">»</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">(</span><span class="n">string</span> <span class="bp">×</span> <span class="n">u32</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="o">(</span><span class="s2">&quot;ref/7 Statements and expressions/7.2 Expressions/7.2.22 Match expressions/lib.rs&quot;</span><span class="o">,</span> <span class="o">(</span><span class="mi">36</span> <span class="o">:</span> <span class="n">nat</span><span class="o">))</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>


<span class="kn">definition</span> <span class="n">test</span><span class="bp">.</span><span class="n">f5</span> <span class="o">(</span><span class="n">xₐ</span> <span class="o">:</span> <span class="o">(</span><span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:</span> <span class="n">sem</span> <span class="o">((</span><span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span> <span class="n">i32</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="err">←</span> <span class="n">xₐ</span><span class="bp">;</span>
<span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">None</span> <span class="o">:=</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t10</span> <span class="err">←</span> <span class="n">test</span><span class="bp">.</span><span class="n">f5</span><span class="bp">.</span><span class="err">«$</span><span class="bp">_</span><span class="n">FILE_LINE</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t9</span> <span class="err">←</span> <span class="n">t10</span><span class="bp">;</span>
<span class="n">mzero</span>
 <span class="bp">|</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">Some</span> <span class="err">«»</span> <span class="o">:=</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">None</span> <span class="o">:=</span> <span class="n">mzero</span>
 <span class="bp">|</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">Some</span> <span class="err">«$</span><span class="mi">0</span><span class="err">»</span> <span class="o">:=</span> <span class="n">return</span> <span class="err">«$</span><span class="mi">0</span><span class="err">»</span>
<span class="kn">end</span>
<span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t6</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t5</span> <span class="err">←</span> <span class="n">t6</span> <span class="bp">&lt;</span><span class="err">ᵇ</span> <span class="o">(</span><span class="mi">10</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span><span class="bp">;</span>
<span class="k">if</span> <span class="n">t5</span> <span class="bp">=</span> <span class="n">bool</span><span class="bp">.</span><span class="n">tt</span> <span class="k">then</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">t7</span> <span class="err">←</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">3</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">Some</span> <span class="n">t7</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="k">else</span>
<span class="kp">do</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span> <span class="err">←</span> <span class="k">match</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">2</span><span class="err">»</span> <span class="k">with</span>
<span class="bp">|</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">None</span> <span class="o">:=</span> <span class="n">mzero</span>
 <span class="bp">|</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">Some</span> <span class="err">«$</span><span class="mi">0</span><span class="err">»</span> <span class="o">:=</span> <span class="n">return</span> <span class="err">«$</span><span class="mi">0</span><span class="err">»</span>
<span class="kn">end</span>
<span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="err">«</span><span class="n">x</span><span class="err">$</span><span class="mi">4</span><span class="err">»</span> <span class="err">←</span> <span class="err">«$</span><span class="n">tmp0</span><span class="err">»</span><span class="bp">;</span>
<span class="k">let</span><span class="bp">&#39;</span> <span class="n">ret</span> <span class="err">←</span> <span class="n">core</span><span class="bp">.</span><span class="n">option</span><span class="bp">.</span><span class="n">Option</span><span class="bp">.</span><span class="n">None</span><span class="bp">;</span>
<span class="n">return</span> <span class="o">(</span><span class="n">ret</span><span class="o">)</span>
<span class="kn">end</span>
</pre></div>
</div>
</div>
<h1 id="type-system"><a href="#type-system" class="success">8 Type system</a>
<a class="ref" href="https://doc.rust-lang.org/reference.html#type-system">[ref]</a>
</h1>
<p>TODO: Should probably discuss the axiomatized primitives and argue for their correctness via example proofs.</p>
</body>
</html>